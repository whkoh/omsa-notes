<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-03-24 Fri 16:59 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ISYE 6501 Intro to Analytics Modeling Notes</title>
<meta name="author" content="W" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/readtheorg.css"/>
<script type="text/javascript" src="src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">ISYE 6501 Intro to Analytics Modeling Notes</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org7f9e394">1. Module 01: Intro</a>
<ul>
<li><a href="#org500cafa">1.1. What's analytics?</a></li>
<li><a href="#org38dd674">1.2. Modeling</a></li>
<li><a href="#org258a33f">1.3. Course structure</a></li>
<li><a href="#org6789732">1.4. Three different things are all models</a></li>
<li><a href="#org98c4bcc">1.5. Hence these are all "models":</a></li>
</ul>
</li>
<li><a href="#org133d123">2. Module 02: Classification</a>
<ul>
<li><a href="#orga5b0e3e">2.1. M1L1: Intro to classification</a></li>
<li><a href="#org6fc0d03">2.2. M1L2: Choosing a Classifier</a>
<ul>
<li><a href="#org187c2d3">2.2.1. Example: Loan payment (Income vs credit score)</a></li>
</ul>
</li>
<li><a href="#org327d2f7">2.3. M2L3 Data definitions</a>
<ul>
<li><a href="#orge7f0acf">2.3.1. Data terminology</a></li>
<li><a href="#orgc9c0033">2.3.2. Data types</a></li>
</ul>
</li>
<li><a href="#orge00d735">2.4. M2L4: Support vector machines</a>
<ul>
<li><a href="#orgb4758d2">2.4.1. When not possible to get full separation</a></li>
</ul>
</li>
<li><a href="#org28f9269">2.5. M2L5: What SVM means</a></li>
<li><a href="#org20d36ef">2.6. M2L6: Advanced SVM</a></li>
<li><a href="#orge0538c6">2.7. M2L7: Scaling and standardization</a>
<ul>
<li><a href="#org7eeb407">2.7.1. Scaling data</a></li>
<li><a href="#org9631f3f">2.7.2. Standardization of data</a></li>
<li><a href="#org9464d40">2.7.3. Choosing between scaling vs standardization</a></li>
</ul>
</li>
<li><a href="#org27b3e9e">2.8. M2L8: K Nearest Neighbour model (KNN)</a></li>
</ul>
</li>
<li><a href="#orgfba1c95">3. Module 03: Validation</a>
<ul>
<li><a href="#org2928c01">3.1. M3L1: Training, validation and test data</a></li>
<li><a href="#org1af64d1">3.2. M3L2: Splitting data</a></li>
<li><a href="#org73367d6">3.3. M3L3: Cross-validation</a></li>
<li><a href="#orgfbcc079">3.4. M3L4: Summary</a></li>
</ul>
</li>
<li><a href="#orgc9b8518">4. Module 04: Clustering</a>
<ul>
<li><a href="#org0c6a328">4.1. M4L1: Introduction to clustering</a></li>
<li><a href="#orge053d69">4.2. M4L2: Distance Norms</a></li>
<li><a href="#orgdff6662">4.3. M4L3: K-Means Clustering</a></li>
<li><a href="#org0312094">4.4. M4L4: Practical details for K-Means</a></li>
<li><a href="#org4b39dca">4.5. M4L5: Clustering for prediction</a></li>
<li><a href="#org2f6e5b9">4.6. M4L6: Clustering vs Classification</a></li>
</ul>
</li>
<li><a href="#orgf7eb965">5. Module 05: Data preparation</a>
<ul>
<li><a href="#org5b2eb82">5.1. M5L1: Common techniques and problems</a></li>
<li><a href="#org45473bf">5.2. M5L2: Outliers</a></li>
<li><a href="#org5ef4efa">5.3. M5L3: What to do with outliers?</a>
<ul>
<li><a href="#org5488c34">5.3.1. Bad data</a></li>
<li><a href="#orgda3045c">5.3.2. Real / correct data</a></li>
<li><a href="#orgdeddc21">5.3.3. Another way to handle outliers</a></li>
<li><a href="#orgc2eb6ec">5.3.4. Summary</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7f5f03e">6. Module 06: Change detection</a>
<ul>
<li><a href="#org807cd0c">6.1. M6L1: Examples</a></li>
<li><a href="#org899d424">6.2. M6L2: Cumulative sum for change detection</a>
<ul>
<li><a href="#org2e8e92a">6.2.1. Interpretation</a></li>
</ul>
</li>
<li><a href="#org4a43af4">6.3. M6L3: Ethics: Honestly reporting our results</a></li>
</ul>
</li>
<li><a href="#org5091500">7. Module 07: Time series</a>
<ul>
<li><a href="#org11736e3">7.1. M7L1: Introduction to exponential smoothing</a>
<ul>
<li><a href="#org0741cbd">7.1.1. Random variation</a></li>
<li><a href="#org53ba9a0">7.1.2. Definitions:</a></li>
<li><a href="#org2a635f2">7.1.3. Exponential smoothing method</a></li>
</ul>
</li>
<li><a href="#orgfbe7010">7.2. M7L2: Trend and cyclic effects</a>
<ul>
<li><a href="#orge99477b">7.2.1. Trends</a></li>
<li><a href="#org75ce53f">7.2.2. Cyclical patterns</a></li>
<li><a href="#orgbeca204">7.2.3. Summary</a></li>
</ul>
</li>
<li><a href="#org4828a5b">7.3. M7L3: Etymology (what the name means)</a>
<ul>
<li><a href="#org67666c7">7.3.1. Summary</a></li>
</ul>
</li>
<li><a href="#orgd6466a2">7.4. M7L4: Forecasting</a></li>
<li><a href="#org82d37f2">7.5. M3L5: ARIMA</a>
<ul>
<li><a href="#org51caa03">7.5.1. (I): Differences</a></li>
<li><a href="#org5a216a8">7.5.2. (II): Autogression</a></li>
<li><a href="#org186febf">7.5.3. (III): Moving Average</a></li>
<li><a href="#orgb6daf6e">7.5.4. ARIMA model</a></li>
</ul>
</li>
<li><a href="#org1561490">7.6. M7L6: GARCH</a>
<ul>
<li><a href="#org27a2a6c">7.6.1. Variance</a></li>
<li><a href="#org686c36d">7.6.2. GARCH</a></li>
<li><a href="#org6d3cb6b">7.6.3. Summary - three models for time series analysis</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org852b758">8. Module 08: Regression</a>
<ul>
<li><a href="#org3e8d52c">8.1. M8L1: Intro to Regression</a>
<ul>
<li><a href="#orgf3c6545">8.1.1. What questions can regression answer?</a></li>
<li><a href="#orgf7c0c27">8.1.2. Simple linear regression</a></li>
</ul>
</li>
<li><a href="#org80a1c7a">8.2. M8L2: Maximum Likelihood and Information Criteria</a>
<ul>
<li><a href="#org3611d60">8.2.1. Likelihood</a></li>
<li><a href="#org1824c64">8.2.2. Maximum likelihood fitting</a></li>
<li><a href="#org94ce709">8.2.3. Akaike Information Criterion</a></li>
<li><a href="#org9125ff0">8.2.4. Corrected AIC (AIC<sub>c</sub>)</a></li>
<li><a href="#org5a908fd">8.2.5. AIC<sub>c</sub> example</a></li>
<li><a href="#orga5e9c28">8.2.6. Bayesian Information Criterion</a></li>
<li><a href="#orgedff5cb">8.2.7. Summary</a></li>
</ul>
</li>
<li><a href="#orgab9880b">8.3. M8L3: Using Regression</a>
<ul>
<li><a href="#org48a5fb6">8.3.1. Regression coefficients</a></li>
</ul>
</li>
<li><a href="#orgb8ab702">8.4. M8L4: Causation vs Correlation</a>
<ul>
<li><a href="#org553fab2">8.4.1. Example: winter recreation</a></li>
<li><a href="#org23014f0">8.4.2. Example: tiredness vs scruffiness</a></li>
<li><a href="#orgab8bcab">8.4.3. How to tell causation?</a></li>
<li><a href="#org9656270">8.4.4. Meaningless correlations</a></li>
</ul>
</li>
<li><a href="#org31ffa65">8.5. M8L5: Transformations and Interactions</a>
<ul>
<li><a href="#orgfe7a8f2">8.5.1. Transforming the data</a></li>
<li><a href="#org30972f6">8.5.2. Interaction terms, e.g. product of inputs</a></li>
</ul>
</li>
<li><a href="#org9291348">8.6. M6L6: Output</a>
<ul>
<li><a href="#org2164bf8">8.6.1. p-Values</a></li>
<li><a href="#orgc9a43f7">8.6.2. Confidence interval</a></li>
<li><a href="#org8930f8e">8.6.3. T-statistic</a></li>
<li><a href="#org50d32f6">8.6.4. Coefficient itself</a></li>
<li><a href="#org1e5c4ca">8.6.5. \(R^2\)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgbdb3413">9. Module 09: Advanced Data Preparation</a>
<ul>
<li><a href="#org121fa0d">9.1. M9L1: Box-Cox Transformations</a></li>
<li><a href="#orgcb38487">9.2. M9L2: Detrending</a></li>
<li><a href="#orgc49d8f9">9.3. M9L3: Intro to PCA</a></li>
<li><a href="#orgfb07c68">9.4. M9L4: Using PCA</a>
<ul>
<li><a href="#org176e5dc">9.4.1. Math of PCA</a></li>
<li><a href="#orgaeb617f">9.4.2. PCA as linear combination</a></li>
<li><a href="#orgd20459a">9.4.3. PCA for regression</a></li>
<li><a href="#org18aaee3">9.4.4. Summary of PCA</a></li>
</ul>
</li>
<li><a href="#org8f6db18">9.5. M9L5: Eigenvalues and Eigenvectors</a>
<ul>
<li><a href="#orga8be895">9.5.1. Initial example</a></li>
<li><a href="#orgbdd82ba">9.5.2. Important: know how eigenvalues and eigenvectors are important to PCA</a></li>
</ul>
</li>
<li><a href="#org3dd7448">9.6. M9L6: PCA: The good and the bad</a>
<ul>
<li><a href="#org23e96cd">9.6.1. Example where PCA is good</a></li>
<li><a href="#orga34b61b">9.6.2. Example where PCA is bad</a></li>
<li><a href="#org8e2610f">9.6.3. Summary</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org36cde0f">10. Module 10: Advanced Regression</a>
<ul>
<li><a href="#orgfd3fe4b">10.1. M10L01: Introduction to CART</a>
<ul>
<li><a href="#orgc8119c6">10.1.1. Trees in regression</a></li>
<li><a href="#orgabdfeaf">10.1.2. Recall</a></li>
<li><a href="#orgb906030">10.1.3. What if responses can be differentiated by a factor?</a></li>
<li><a href="#org0c8aa8f">10.1.4. Further splits are possible</a></li>
<li><a href="#org0ff9388">10.1.5. Disadvantages</a></li>
<li><a href="#org4d1b2d9">10.1.6. Other places to use trees</a></li>
<li><a href="#org67c6b11">10.1.7. Common questions</a></li>
<li><a href="#orgb1463a9">10.1.8. Etymology of "tree"</a></li>
</ul>
</li>
<li><a href="#orgb68d34d">10.2. M10L02: Branching</a>
<ul>
<li><a href="#org835c353">10.2.1. Main questions</a></li>
<li><a href="#org9d4e0a4">10.2.2. Branching methods</a></li>
<li><a href="#orgc41caee">10.2.3. Generic branching concept</a></li>
</ul>
</li>
<li><a href="#orga42c8b8">10.3. M10L03: Random Forests</a>
<ul>
<li><a href="#org1a88515">10.3.1. Intro summary</a></li>
<li><a href="#org0425c47">10.3.2. Introducing randomness</a></li>
<li><a href="#org6b5c5bb">10.3.3. Note</a></li>
<li><a href="#orgdc41935">10.3.4. Summary of RF</a></li>
</ul>
</li>
<li><a href="#org8552088">10.4. M10L04: Explainability and Interpretability</a>
<ul>
<li><a href="#org2ef9510">10.4.1. Example: linear regression</a></li>
<li><a href="#org539bd50">10.4.2. Example: regression tree</a></li>
<li><a href="#org326816d">10.4.3. Example: random forests</a></li>
<li><a href="#org099e94a">10.4.4. Comparisons</a></li>
<li><a href="#orge0bfa3b">10.4.5. Tradeoff</a></li>
</ul>
</li>
<li><a href="#org8de9ae7">10.5. M10L05: Confusion Matrices</a>
<ul>
<li><a href="#org3b393e3">10.5.1. Details</a></li>
<li><a href="#orgd784c93">10.5.2. Definitions</a></li>
</ul>
</li>
<li><a href="#orga9c15f4">10.6. M10L06: Situationally-Driven Comparisons</a>
<ul>
<li><a href="#orgca40bf9">10.6.1. Example: from spam detection</a></li>
<li><a href="#org47478a1">10.6.2. Evaluating quality / changing metrics</a></li>
</ul>
</li>
<li><a href="#orgad68737">10.7. L10L07: Advanced Topics in Regression</a>
<ul>
<li><a href="#orgd46467c">10.7.1. Poisson regression</a></li>
<li><a href="#org500803f">10.7.2. Regression splines</a></li>
<li><a href="#org2770bb4">10.7.3. Bayesian regression</a></li>
<li><a href="#org989a5ce">10.7.4. k-Nearest Neighbour Regression</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9a0c513">11. Module 11: Variable Selection</a>
<ul>
<li><a href="#org8f6ac52">11.1. M11L1: Introduction</a>
<ul>
<li><a href="#orgd86bea6">11.1.1. Why bother limiting factors?</a></li>
</ul>
</li>
<li><a href="#org65edc62">11.2. M11L2: Models for variable selection</a>
<ul>
<li><a href="#org5556535">11.2.1. Forward selection</a></li>
<li><a href="#orgcc5206d">11.2.2. Backward elimination</a></li>
<li><a href="#org1193637">11.2.3. Stepwise regression</a></li>
<li><a href="#org53d7991">11.2.4. Types of approaches</a></li>
<li><a href="#orga1fa3a5">11.2.5. Lasso approach</a></li>
<li><a href="#org72abe28">11.2.6. Elastic net</a></li>
<li><a href="#orgb8bba54">11.2.7. Ridge regression</a></li>
</ul>
</li>
<li><a href="#org0ab502a">11.3. M11L3: Lasso vs Ridge regression</a></li>
<li><a href="#orgfd60b53">11.4. M11L4: Bias-Variance tradeoff</a></li>
<li><a href="#org7f3fc2f">11.5. M11L5: Ridge regression / regularization</a></li>
<li><a href="#orgea84824">11.6. M11L6: Choosing a variable selection model</a></li>
</ul>
</li>
<li><a href="#org536014e">12. Module 12: Design of Experiments</a>
<ul>
<li><a href="#org6709271">12.1. M12L1: Intro</a>
<ul>
<li><a href="#org7072bd1">12.1.1. Comparison and control</a></li>
<li><a href="#orgbb67f8c">12.1.2. Blocking</a></li>
</ul>
</li>
<li><a href="#org1c19cf4">12.2. M12L2: A/B testing</a>
<ul>
<li><a href="#org8bfa0fc">12.2.1. Required to use A/B testing</a></li>
</ul>
</li>
<li><a href="#org2f3018d">12.3. M12L3: Factorial design</a>
<ul>
<li><a href="#orgb813e36">12.3.1. Full factorial design</a></li>
<li><a href="#org7821661">12.3.2. Fractional factorial design</a></li>
<li><a href="#orgb13c12e">12.3.3. Independent factors</a></li>
<li><a href="#org8b64d70">12.3.4. Summary</a></li>
</ul>
</li>
<li><a href="#orgd9b647d">12.4. M12L4: Multi-armed bandits</a>
<ul>
<li><a href="#org7fdf6fa">12.4.1. Exploration vs exploitation</a></li>
<li><a href="#orgb856e1d">12.4.2. Multi-armed bandit</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1dc76ba">13. Module 13: Probability-based Models</a>
<ul>
<li><a href="#org2efc68a">13.1. M13L1: Intro</a>
<ul>
<li><a href="#org6189096">13.1.1. Simple modelling</a></li>
<li><a href="#org0bc4f5a">13.1.2. Example on ticket owner not showing up</a></li>
<li><a href="#orga7b3e7b">13.1.3. Summary</a></li>
</ul>
</li>
<li><a href="#org45fd3a7">13.2. M13L2: Bernoulli, Binomial and Geometric Distributions</a>
<ul>
<li><a href="#orga7f2e6b">13.2.1. Bernoulli distribution</a></li>
<li><a href="#org43c5fdc">13.2.2. Binomial distribution</a></li>
<li><a href="#org3583403">13.2.3. Geometric distribution</a></li>
</ul>
</li>
<li><a href="#org67a3d44">13.3. M13L3: Poisson, Weibull and Exponential Distributions</a>
<ul>
<li><a href="#org5673c68">13.3.1. Poisson</a></li>
<li><a href="#orga5aadb3">13.3.2. Exponential distribution</a></li>
<li><a href="#org632241d">13.3.3. Weibull</a></li>
<li><a href="#org0e78986">13.3.4. Software can help but may be confusing</a></li>
</ul>
</li>
<li><a href="#org1e919f4">13.4. M13L4: Q-Q plots</a>
<ul>
<li><a href="#org7a8bc4c">13.4.1. Visualizing</a></li>
<li><a href="#org458d016">13.4.2. Types of Q-Q plots</a></li>
</ul>
</li>
<li><a href="#org04492ea">13.5. M13L5: Queuing</a>
<ul>
<li><a href="#org161319f">13.5.1. Queuing example</a></li>
<li><a href="#orgbb74523">13.5.2. More complex example</a></li>
<li><a href="#orgb51d893">13.5.3. Queuing models</a></li>
</ul>
</li>
<li><a href="#orge202110">13.6. M13L6: Simulation basics</a>
<ul>
<li><a href="#orga382f02">13.6.1. Types of simulations</a></li>
<li><a href="#org61e9b4a">13.6.2. Discrete-event stochastic simulations</a></li>
<li><a href="#orgbecacc4">13.6.3. Simulation software</a></li>
<li><a href="#org0b17dc4">13.6.4. Replications</a></li>
<li><a href="#org216a206">13.6.5. Simulation validation</a></li>
</ul>
</li>
<li><a href="#orgc500027">13.7. M13L7: Prescriptive simulation</a>
<ul>
<li><a href="#orgf322c2f">13.7.1. Simulation comparisons</a></li>
<li><a href="#org0664bfa">13.7.2. Validation can be hard</a></li>
<li><a href="#org02c4c4c">13.7.3. Simulation/validation should consider all processes</a></li>
</ul>
</li>
<li><a href="#org5bc3023">13.8. M13L8: Markov chains</a>
<ul>
<li><a href="#orge094b96">13.8.1. Answering questions with the transition matrix</a></li>
<li><a href="#orgd6b5550">13.8.2. Key assumption</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org18433fa">14. Module 14: Missing Data</a></li>
<li><a href="#org76dd339">15. Module 15: Optimization</a></li>
<li><a href="#org3f41c67">16. Module 16: Advanced Models</a></li>
</ul>
</div>
</div>
<div id="outline-container-org7f9e394" class="outline-2">
<h2 id="org7f9e394"><span class="section-number-2">1.</span> Module 01: Intro</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org500cafa" class="outline-3">
<h3 id="org500cafa"><span class="section-number-3">1.1.</span> What's analytics?</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Analytics answers these questions
</p>
<ol class="org-ol">
<li>Descriptive - what happened</li>
<li>Predictive - what will happen</li>
<li>Prescriptive - what action is best</li>
<li>General questions</li>
</ol>
</div>
</div>
<div id="outline-container-org38dd674" class="outline-3">
<h3 id="org38dd674"><span class="section-number-3">1.2.</span> Modeling</h3>
<div class="outline-text-3" id="text-1-2">
<ol class="org-ol">
<li>Describe real-life situation with math</li>
<li>Analyze math</li>
<li>Turn math answer back to real situation</li>
</ol>
</div>
</div>
<div id="outline-container-org258a33f" class="outline-3">
<h3 id="org258a33f"><span class="section-number-3">1.3.</span> Course structure</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Enough math intuition and detail
</p>
<ul class="org-ul">
<li>Models
<ul class="org-ul">
<li>Machine learning</li>
<li>Regression</li>
<li>Optimizaton</li>
</ul></li>
<li>Cross-cutting
<ul class="org-ul">
<li>Data prep</li>
<li>Output quality</li>
<li>Missing data</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org6789732" class="outline-3">
<h3 id="org6789732"><span class="section-number-3">1.4.</span> Three different things are all models</h3>
<div class="outline-text-3" id="text-1-4">
<ol class="org-ol">
<li>Real life situation expressed as math</li>
<li>Analyse the math</li>
<li>Turn mathematical analyse to real-life solution</li>
</ol>
</div>
</div>
<div id="outline-container-org98c4bcc" class="outline-3">
<h3 id="org98c4bcc"><span class="section-number-3">1.5.</span> Hence these are all "models":</h3>
<div class="outline-text-3" id="text-1-5">
<ol class="org-ol">
<li>Regression</li>
<li>Regression on size, weight, distance</li>
<li>Regression estimate = 37+81*Size +76*Wt, etc</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org133d123" class="outline-2">
<h2 id="org133d123"><span class="section-number-2">2.</span> Module 02: Classification</h2>
<div class="outline-text-2" id="text-2">
<blockquote>
<p>
Definition: putting things into groups
</p>
</blockquote>
</div>
<div id="outline-container-orga5b0e3e" class="outline-3">
<h3 id="orga5b0e3e"><span class="section-number-3">2.1.</span> M1L1: Intro to classification</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Types of classification models
</p>
<ol class="org-ol">
<li>Number of groups</li>
<li>Number of dimensions
<ul class="org-ul">
<li>Can 1 dimension be sufficient to classify?</li>
</ul></li>
<li>Soft vs hard classifiers (is it 100% error-free?)</li>
</ol>
</div>
</div>
<div id="outline-container-org6fc0d03" class="outline-3">
<h3 id="org6fc0d03"><span class="section-number-3">2.2.</span> M1L2: Choosing a Classifier</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Definition of bad classification
</p>
<ul class="org-ul">
<li>Cost: is one type of mistake worse than the other?</li>
</ul>
</div>
<div id="outline-container-org187c2d3" class="outline-4">
<h4 id="org187c2d3"><span class="section-number-4">2.2.1.</span> Example: Loan payment (Income vs credit score)</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li>Plot lines and find one that can separate default vs non-default.</li>
<li>How do we know the right lines are drawn?</li>
<li>We want to be as conservative as possible (less error prone)</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org327d2f7" class="outline-3">
<h3 id="org327d2f7"><span class="section-number-3">2.3.</span> M2L3 Data definitions</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orge7f0acf" class="outline-4">
<h4 id="orge7f0acf"><span class="section-number-4">2.3.1.</span> Data terminology</h4>
<div class="outline-text-4" id="text-2-3-1">
<ol class="org-ol">
<li>Row = data point</li>
<li>Column = dimension, attribute, feature, predictor, covariate
<ol class="org-ol">
<li>Special column = response, outcome</li>
</ol></li>
</ol>
</div>
</div>
<div id="outline-container-orgc9c0033" class="outline-4">
<h4 id="orgc9c0033"><span class="section-number-4">2.3.2.</span> Data types</h4>
<div class="outline-text-4" id="text-2-3-2">
<ol class="org-ol">
<li>Structured data
<ol class="org-ol">
<li>Quantitative
<ul class="org-ul">
<li>Numbers with meaning</li>
</ul></li>
<li>Categorical
<ul class="org-ul">
<li>Numbers without meaning</li>
</ul></li>
<li>Binary data (subset of categorical)</li>
<li>Unrelated data</li>
<li>Time series data</li>
</ol></li>
<li>Unstructured
<ol class="org-ol">
<li>Text data</li>
</ol></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orge00d735" class="outline-3">
<h3 id="orge00d735"><span class="section-number-3">2.4.</span> M2L4: Support vector machines</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li><b>Supervised</b> method (algorithm uses known results when training)</li>
<li>Terminology
<ul class="org-ul">
<li>m = number of data points</li>
<li>n = number of attributes</li>
<li>x<sub>ij</sub> = j attribute of i data point
<ul class="org-ul">
<li>e.g. x<sub>51</sub> = credit score of person 5; x<sub>52</sub> = income of person 5</li>
</ul></li>
<li>y<sub>i</sub> = response of data point i
<ul class="org-ul">
<li>e.g. 1 if data point is group 1</li>
<li>-1 if data point is group 2</li>
</ul></li>
<li>Line: \(a_1 x_1\) + \(a_2 x_2\) + &#x2026; + \(a_n x_n\) + \(a_0\) = 0</li>
<li>Note the intercept \(a_0\)</li>
</ul></li>
<li>In general: \(\sum_{j=1}^{n} a_j x_j + a_0 = 0\)</li>
<li>Separation problem: get max distance between lines</li>
<li>\(2\over{\sqrt(\sum_{j} \left(a_j\right)^2)}\)</li>
<li>i.e. Min<sub>a<sub>0</sub> &#x2026; a<sub>n</sub></sub>: \(\sum_{j=1}^{n}\left(a_j\right)^2\)</li>
<li>Subject to constraints</li>
</ul>
</div>
<div id="outline-container-orgb4758d2" class="outline-4">
<h4 id="orgb4758d2"><span class="section-number-4">2.4.1.</span> When not possible to get full separation</h4>
<div class="outline-text-4" id="text-2-4-1">
<ul class="org-ul">
<li>Then we minimize error</li>
<li>There's a trade-off between margin and error</li>
<li>Error for data point is:
\[
  \text{max} \{ 0, 1-(\sum_{j=1}^{n} a_j x_{ij} + a_0) y_i \}
  \]</li>
<li>Total error is:
\[
  \sum_{i=1}^{m} \text{max} \{ 0, 1 - (\sum_{j=1}^{n} a_j x_{ij} + a_0) y_i \}
  \]</li>
<li>Margin denominator: \(\sum_{j=1}^{n}(a_j)^2\)</li>

<li>We multiply margin by \(\lambda\) to <b>assign its importance of margin vs error</b>.</li>
<li>Hence, the full equation is:
\[
  \text{Minimize}_{a_0,...,a_n} \sum_{i=1}^{m} \text{max} \{ 0, 1 - (\sum_{j=1}^{n} a_j x_{ij} + a_0) y_i \}  + \lambda \sum_{j=1}^{n}(a_j)^2
  \]</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org28f9269" class="outline-3">
<h3 id="org28f9269"><span class="section-number-3">2.5.</span> M2L5: What SVM means</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>Etymology
<ul class="org-ul">
<li>Vector = point</li>
<li><b>Support vector</b> = points that holds up (or, supports) a shape. Shape is correctly balanced on parallel lines</li>
<li>Model determines the "support vectors"</li>
<li>Automatically from data hence "<b>machine</b>"</li>
</ul></li>
<li>Support can be from top or side</li>
<li>Looking for max separation i.e. the support vector touches the data points</li>
<li>Classifier is in between the two support vectors</li>
</ul>
</div>
</div>
<div id="outline-container-org20d36ef" class="outline-3">
<h3 id="org20d36ef"><span class="section-number-3">2.6.</span> M2L6: Advanced SVM</h3>
<div class="outline-text-3" id="text-2-6">
<ul class="org-ul">
<li>The constant term a<sub>0</sub> can be used to adjust the intercept and hence tweak the SVM model.
<ul class="org-ul">
<li>If it's more costly to grant a bad loan, e.g.: \(\frac{2}{3}(a_0-1) + \frac{1}{3}(a_0+1)\)</li>
</ul></li>
<li>For soft classification, you can add a multiplier m<sub>j</sub> for each type of error:
<ul class="org-ul">
<li>m<sub>j</sub> &gt; 1 for more costly</li>
<li>m<sub>j</sub> &lt; 1 for less costly</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orge0538c6" class="outline-3">
<h3 id="orge0538c6"><span class="section-number-3">2.7.</span> M2L7: Scaling and standardization</h3>
<div class="outline-text-3" id="text-2-7">
<ul class="org-ul">
<li>Predictive factors may have different orders of magnitude, i.e.
<ul class="org-ul">
<li>Income in \(10^5\)</li>
<li>Credit score in \(10^2\)</li>
<li>Classifier is \(0 = a_0 + \sum_{j} a_j x_j\)</li>
<li>Maximise gap by minimizing: \(\sum_{j} a_j^2\)</li>
<li>Coefficients might be 10<sup>6</sup> + 5*income + 701*credit score
<ul class="org-ul">
<li>Sum of squared coefficients:
\(\sum_j a_j^2 = 5^2 + 700^2 = 490,025\)</li>
<li>Changing credit score by 1 increases the sum by 1,401:
\(\sum_j a_j^2 = 5^2 + 701^2 = 491,426\)</li>
</ul></li>
<li>Small change in one coefficient affects the sum a lot due to difference in scales.
<ul class="org-ul">
<li>As data has such different scale.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="outline-container-org7eeb407" class="outline-4">
<h4 id="org7eeb407"><span class="section-number-4">2.7.1.</span> Scaling data</h4>
<div class="outline-text-4" id="text-2-7-1">
<ul class="org-ul">
<li>Common scale is between 0 and 1</li>
<li>Scale data by factor
\[
  x_{ij}^{\text{scaled}} = \frac{x_{ij}-x_{\text{min}j}}{x_{\text{max}j} - x_{\text{min}j}}
  \]</li>
<li>General scaling between a, b:
\[
  x_{ij}^{\text{scaled}[b,a]} = x_{ij}^{\text{scaled}[0,1]}(a-b)+b
  \]</li>
</ul>
</div>
</div>
<div id="outline-container-org9631f3f" class="outline-4">
<h4 id="org9631f3f"><span class="section-number-4">2.7.2.</span> Standardization of data</h4>
<div class="outline-text-4" id="text-2-7-2">
<ul class="org-ul">
<li>Scale to normal distribution</li>
<li>Common scale is:
<ul class="org-ul">
<li>Mean = 0</li>
<li>SD = 1</li>
</ul></li>
<li>Factor j has:
<ul class="org-ul">
<li>mean \(\mu_j = \frac{\sum_{i=1}^n x_{ij}}{n}\)</li>
<li>SD \(\sigma_j\)</li>
</ul></li>
<li>For each data point \(i\):
\[
  x_{ij}^{\text{standardized}} = \frac{x_{ij}-\mu_j}{\sigma_j}
  \]</li>
</ul>
</div>
</div>
<div id="outline-container-org9464d40" class="outline-4">
<h4 id="org9464d40"><span class="section-number-4">2.7.3.</span> Choosing between scaling vs standardization</h4>
<div class="outline-text-4" id="text-2-7-3">
<ul class="org-ul">
<li>Scale when:
<ul class="org-ul">
<li>Data is in bounded (defined) range, e.g.
<ul class="org-ul">
<li>Neural networks</li>
<li>Optimization models requiring bounded data</li>
<li>Batting averages (between 0 and 1)</li>
<li>RGB color scale (0-255)</li>
<li>SAT scores (200-800)</li>
</ul></li>
</ul></li>
<li>Standardization, examples:
<ul class="org-ul">
<li>PCA</li>
<li>Clustering</li>
</ul></li>
<li>Try both when not clear</li>
<li>Should be used throughout course even when not stated explicitly</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org27b3e9e" class="outline-3">
<h3 id="org27b3e9e"><span class="section-number-3">2.8.</span> M2L8: K Nearest Neighbour model (KNN)</h3>
<div class="outline-text-3" id="text-2-8">
<ul class="org-ul">
<li><b>Classification</b></li>
<li>e.g. loan dataset with two predictors and a response</li>
<li>Assume each point has similar characteristics with its neighbors</li>
<li>Choice of number of points is denoted by \(k\)</li>
<li>Algorithm to find color (class) of a new point:
<ol class="org-ol">
<li>Pick \(k\) closest points (i.e., nearest neighbours) to the new one</li>
<li>The new point's class is the most common among the \(k\) neighbors</li>
</ol></li>
<li>Complexities
<ul class="org-ul">
<li>More than one distance metric (<i>c.f.</i> distance selection topic_).
<ul class="org-ul">
<li>Straight line is: \(\sqrt{\sum_{i=1}^n |x_i-y_i|^2}\)</li>
</ul></li>
<li>Attributes can be given more weight if more important, \(w_i\)
<ul class="org-ul">
<li>Weights to be found with other techniques e.g. regression</li>
</ul></li>
<li>Unimportant metrics can be removed
<ul class="org-ul">
<li><i>c.f.</i> variable selection topic</li>
<li>Choose good value of \(k\), <i>c.f.</i> validation @ <a href="#orgfba1c95">3</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgfba1c95" class="outline-2">
<h2 id="orgfba1c95"><span class="section-number-2">3.</span> Module 03: Validation</h2>
<div class="outline-text-2" id="text-3">
<blockquote>
<p>
Check how good a model is
</p>
</blockquote>
</div>
<div id="outline-container-org2928c01" class="outline-3">
<h3 id="org2928c01"><span class="section-number-3">3.1.</span> M3L1: Training, validation and test data</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li><b>Cannot</b> calculate accuracy or effectiveness metrics from training dataset
<ul class="org-ul">
<li>Since model was trained on it</li>
<li>This doesn't allow separation of real effects from random effects</li>
</ul></li>
<li>When fitting a model, this captures both real and random effects
<ul class="org-ul">
<li>Real effects: exist in all datasets (or subsets)</li>
<li>Random effects: different in all datasets</li>
</ul></li>
<li>Use a <b>training</b> set of data to fit model</li>
<li>Use another <b>validation</b> set of data to judge model effectiveness</li>
<li>When comparing &gt;1 model, use a <b>test</b> dataset.
<ul class="org-ul">
<li>e.g. SVM and KNN, with 10 total models, we cannot use the effectiveness metric calculated on the validation set.</li>
</ul></li>
<li>Test data is required as high performing models have above average random effects
<ul class="org-ul">
<li>Too optimistic; it might have performed well but also likely received a boost from random effects</li>
</ul></li>
<li>Analogize with models equally good</li>
<li>Flowchart:
<img src="./img/validation01.png" alt="validation01.png" /></li>
</ul>
</div>
</div>
<div id="outline-container-org1af64d1" class="outline-3">
<h3 id="org1af64d1"><span class="section-number-3">3.2.</span> M3L2: Splitting data</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>How much data goes to each set?
<ol class="org-ol">
<li>70 to 90% train, remaining test</li>
<li>50 to 70% train, remaining evenly split validation &amp; test</li>
</ol></li>
<li>Methods of splitting data
<ol class="org-ol">
<li>Random</li>
<li>Rotation (take turn selecting data points into training, test, valid across the sets of split data)
<ul class="org-ul">
<li>Advantage: in time series data, may avoid all datasets having early/late data</li>
<li>Need to ensure rotation doesn't introduce bias</li>
</ul></li>
<li>Combined:
60% of Monday data for training, 60^% of Tuesday data for training, etc.</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org73367d6" class="outline-3">
<h3 id="org73367d6"><span class="section-number-3">3.3.</span> M3L3: Cross-validation</h3>
<div class="outline-text-3" id="text-3-3">
<blockquote>
<p>
What happens with important data appears only in one data set e.g., validation?
</p>
</blockquote>
<ul class="org-ul">
<li>Use cross-validation!</li>
<li>k-fold cross validation
<ol class="org-ol">
<li>Split data for testing (e.g. 20%)</li>
<li>With remaining data, use it for both training and validation by splitting into 4 x 20%, then:
<ol class="org-ol">
<li>Train 1, 2, 3, Validate 4</li>
<li>Train 1, 2, 4, Validate 3</li>
<li>Train 1, 3, 4, Validate 2</li>
<li>Train 2, 3, 4, Validate 1</li>
</ol></li>
</ol></li>
<li>Summary of k-fold cross-validation:
<ul class="org-ul">
<li>Train model on all other parts</li>
<li>Evaluate model on remaining part</li>
<li>Average \(k\) evaluations to estimate the model quality.</li>
<li>\(10\) is commonly selected for \(k\).</li>
<li><b>But</b>, the model selected from cross-validation is not used. Coefficients should also not be averaged.</li>
<li>Once model is selected, <b>retrain</b> with all data</li>
</ul></li>
<li>Advantages of k-fold cross-validation:
<ol class="org-ol">
<li>Better uses data</li>
<li>Better estimates model quality</li>
<li>Choose model more effectively</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgfbcc079" class="outline-3">
<h3 id="orgfbcc079"><span class="section-number-3">3.4.</span> M3L4: Summary</h3>
<div class="outline-text-3" id="text-3-4">
<ol class="org-ol">
<li>Build model with training data</li>
<li>Pick model with validation data</li>
<li>Estimate performance with test data</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgc9b8518" class="outline-2">
<h2 id="orgc9b8518"><span class="section-number-2">4.</span> Module 04: Clustering</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org0c6a328" class="outline-3">
<h3 id="org0c6a328"><span class="section-number-3">4.1.</span> M4L1: Introduction to clustering</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li><b>Unsupervised</b> method (response not available for use in training)</li>
<li>Grouping data points</li>
<li>Might help discover attributes in the dataset</li>
<li>Example of use
<ul class="org-ul">
<li>Segmenting market of car buyers by:
<ol class="org-ol">
<li>Size</li>
<li>Price</li>
<li>Versatility, etc</li>
</ol></li>
<li>Personalized medicine</li>
<li>Locating facilities</li>
<li>Image analysis</li>
<li>Exploratory data analysis (different model for each attribute)</li>
</ul></li>
<li>Example: Miles driven vs. Age</li>
</ul>
</div>
</div>
<div id="outline-container-orge053d69" class="outline-3">
<h3 id="orge053d69"><span class="section-number-3">4.2.</span> M4L2: Distance Norms</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>Straight line distance (Euclidean)
\(\sqrt{(x_1-y_1)^2+(x_2-y_2)^2}\)</li>
<li>Rectilinear distance (Manhattan, 1-norm)
\(|x_1-y_1| + |x_2-y_2|\)</li>
<li>Generalized p-norm (Minkowski)
\(\sqrt[p]{|x_1-y_1|^p+|x_2-y_2|^p}\)</li>
<li>&infin;-norm distance
\(\sqrt[\infty]{\sum_{i=1}^n|x_i-y_i|^{\infty}}\)
<ul class="org-ul">
<li>sum = \(|x_i-y_i|^{\infty}\)</li>
<li>\(\sqrt[\infty]{\text{max}_{i}^n|x_i-y_i|^{\infty}}\)</li>
<li>Largest term dominates the rest, hence simplifies to:</li>
<li>\(\text{max}_i |x_i-y_i|\)</li>
</ul></li>
<li>Analogize with warehouse picking robot. The operation that takes the longest dominates the total operation time.</li>
</ul>
</div>
</div>
<div id="outline-container-orgdff6662" class="outline-3">
<h3 id="orgdff6662"><span class="section-number-3">4.3.</span> M4L3: K-Means Clustering</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li><b>Unsupervised</b> technique</li>
<li>Steps to implement K-Means:
<ol class="org-ol">
<li>Plot data points on suitable axes (e.g., age vs temperature, sepal width vs sepal height)</li>
<li>Let:
<ul class="org-ul">
<li>\(x_{ij}\) = attribute \(j\) of data point \(i\)</li>
<li>\(y_{ik}\) = \(1\) iif data point \(i\) in cluster \(k\), else \(0\)</li>
<li>\(z_{jk}\) = coordinate \(j\) of cluster center \(k\)</li>
<li>Mathematically, but it takes too long:
\[
       \text{Min}_{y,z}\sum_i\sum_k \sqrt{\sum_{j} (x_{ij} - z_{jk})^2}
       \]
subject to: \(\sum_k y_{ik} = 1\) for each \(i\)</li>
</ul></li>
<li>Practical method:
<ul class="org-ul">
<li>Pick \(k\) cluster centers in data</li>
<li>Assign each point to nearest cluster center</li>
<li>Recalculate cluster center (centroid)
<ul class="org-ul">
<li>Now, data points might not belong to the right cluster</li>
</ul></li>
<li>Go back to assign, then re-calc, then assign, then re-calc iteratively until stable</li>
</ul></li>
<li>K-Means is a <b>heuristic</b>, i.e.:
<ul class="org-ul">
<li>it is fast and good</li>
<li><b>not guaranteed</b> to find global best solution.</li>
</ul></li>
<li>It is expectation-maximization (EM), and alternates between expectation (<i>finding cluster centers</i>) and maximization (<i>assigning points to clusters</i>)</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org0312094" class="outline-3">
<h3 id="org0312094"><span class="section-number-3">4.4.</span> M4L4: Practical details for K-Means</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Algorithm just assigns outliers to nearest clusters.
</p>
<ul class="org-ul">
<li>Choosing <b>starting points</b>:
<ol class="org-ol">
<li>Run several times with different initial cluster centers</li>
<li>Algorithm is non-deterministic, <i>i.e.</i> can produce different results when run with different inputs</li>
<li>Choose the best solution from the results produced</li>
</ol></li>
<li>Handling <b>outliers</b>:
<ol class="org-ol">
<li>Discard, but may not be the 'right' answer</li>
<li>Ask why the outlier happens
<ul class="org-ul">
<li>What it means to discard or include the outlier</li>
<li>Ultimately, algorithm is just a guide. Best solution is what fits the situation.</li>
</ul></li>
</ol></li>
<li>Choosing <b>number of clusters</b>. Is adding a cluster always better?
<ul class="org-ul">
<li>It may increase the metric (total distance of each data point to their cluster center), hence clustering appears to work better.</li>
<li>However, it may defeat the purpose of clustering if every cluster just consists of one data point.</li>
</ul></li>
<li>Total distance can be compared to find the 'kink' or 'elbow'.
<ul class="org-ul">
<li>After this point, the marginal benefit of adding another cluster decreases.</li>
<li><p>
Elbow diagram:
</p>


<div id="org58b3589" class="figure">
<p><img src="./img/04-elbow.png" alt="04-elbow.png" />
</p>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org4b39dca" class="outline-3">
<h3 id="org4b39dca"><span class="section-number-3">4.5.</span> M4L5: Clustering for prediction</h3>
<div class="outline-text-3" id="text-4-5">
<blockquote>
<p>
Given a new point, which cluster should it be in?
</p>
</blockquote>
<ul class="org-ul">
<li>Is point inside cluster?</li>
<li>Otherwise, what's the nearest cluster center?</li>
<li>Asked another way: for the range of the dataset, which areas would we assign to each cluster if a new point appears there?
<ul class="org-ul">
<li>This is a <a href="https://en.wikipedia.org/wiki/Voronoi_diagram">Voronoi diagram</a>.</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org2f6e5b9" class="outline-3">
<h3 id="org2f6e5b9"><span class="section-number-3">4.6.</span> M4L6: Clustering vs Classification</h3>
<div class="outline-text-3" id="text-4-6">
<ul class="org-ul">
<li>Since both group data points&#x2026;</li>
<li>The difference is what we know about the data points.</li>
<li>For classification, the correct response is known, i.e.
<ul class="org-ul">
<li>supervised learning</li>
<li>model uses both attributes <b>and</b> response</li>
</ul></li>
<li>For clustering, the 'correct' classification is unknown
<ul class="org-ul">
<li>unsupervised learning</li>
<li>model decides clusters <b>only</b> based on the attributes</li>
</ul></li>
<li>Supervised learning is more common</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgf7eb965" class="outline-2">
<h2 id="orgf7eb965"><span class="section-number-2">5.</span> Module 05: Data preparation</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org5b2eb82" class="outline-3">
<h3 id="org5b2eb82"><span class="section-number-3">5.1.</span> M5L1: Common techniques and problems</h3>
<div class="outline-text-3" id="text-5-1">
<ol class="org-ol">
<li>Scale data
<ul class="org-ul">
<li>Outliers?</li>
</ul></li>
<li>Extraneous (unnecessary data)
<ul class="org-ul">
<li>Complicates the model and</li>
<li>Makes it harder to interpret the solution</li>
</ul></li>
</ol>
</div>
</div>
<div id="outline-container-org45473bf" class="outline-3">
<h3 id="org45473bf"><span class="section-number-3">5.2.</span> M5L2: Outliers</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>Types
<dl class="org-dl">
<dt>Point outliers</dt><dd>one / few points very different from others</dd>
<dt>Contextual outlier</dt><dd>Value far from other points in time (not in absolute value)</dd>
<dt>Collective outlier</dt><dd>Something missing in a range of points, but not sure exactly where. Outlier by omission.</dd>
</dl></li>
<li>How to detect?
<ul class="org-ul">
<li>Box-and-whisker plot if data can be plotted in 1-dimension
<ul class="org-ul">
<li>Box: 25/75th percentile
<ul class="org-ul">
<li>Line: 50th percentile</li>
</ul></li>
<li>Whiskers: 10/90th percentile, 5/95th, etc</li>
</ul></li>
<li>For multi-dimensional, no good way. We can still:
<ol class="org-ol">
<li>Fit a model.</li>
<li>Points with large error might be outlier</li>
</ol></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org5ef4efa" class="outline-3">
<h3 id="org5ef4efa"><span class="section-number-3">5.3.</span> M5L3: What to do with outliers?</h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li>Need to understand why there's outliers
<ol class="org-ol">
<li>Bad data
<ul class="org-ul">
<li>Sensor fail</li>
<li>Contaminated experiment</li>
<li>Wrong data input</li>
</ul></li>
<li>Unexpected, real, data
<ul class="org-ul">
<li>Need to understand more about the data, e.g.</li>
<li>Where it came from</li>
<li>How it was compiled</li>
<li>Unique situations</li>
</ul></li>
</ol></li>
</ul>
</div>
<div id="outline-container-org5488c34" class="outline-4">
<h4 id="org5488c34"><span class="section-number-4">5.3.1.</span> Bad data</h4>
<div class="outline-text-4" id="text-5-3-1">
<ul class="org-ul">
<li>Omit the points</li>
<li>Use imputation to replace the points</li>
</ul>
</div>
</div>
<div id="outline-container-orgda3045c" class="outline-4">
<h4 id="orgda3045c"><span class="section-number-4">5.3.2.</span> Real / correct data</h4>
<div class="outline-text-4" id="text-5-3-2">
<ul class="org-ul">
<li>Outliers are somewhat expected in large datasets</li>
<li>E.g., for normally-distributed data:
<ul class="org-ul">
<li>4% will be outside 2 &sigma;</li>
<li>1e6 data points = 2000 outside 3 &sigma;</li>
</ul></li>
<li>Removing <b>real</b> outliers might make model too optimistic. <i>e.g.</i> not account for actual shipments that take a long time from US to Africa</li>
<li>Outliers might be due to weather, political events</li>
</ul>
</div>
</div>
<div id="outline-container-orgdeddc21" class="outline-4">
<h4 id="orgdeddc21"><span class="section-number-4">5.3.3.</span> Another way to handle outliers</h4>
<div class="outline-text-4" id="text-5-3-3">
<ol class="org-ol">
<li>First build a logistic regression model
<ul class="org-ul">
<li>This estimated probability of outliers under different conditions</li>
</ul></li>
<li>Next, build the regular model i.e. estimate delivery time under <b>normal conditions</b>
<ul class="org-ul">
<li>Use data without outliers</li>
<li>Report different outcomes&#x2026;</li>
</ul></li>
</ol>
</div>
</div>
<div id="outline-container-orgc2eb6ec" class="outline-4">
<h4 id="orgc2eb6ec"><span class="section-number-4">5.3.4.</span> Summary</h4>
<div class="outline-text-4" id="text-5-3-4">
<ul class="org-ul">
<li>Outliers aren't predictable</li>
<li>Investigate the data in case you're wrong</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org7f5f03e" class="outline-2">
<h2 id="org7f5f03e"><span class="section-number-2">6.</span> Module 06: Change detection</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org807cd0c" class="outline-3">
<h3 id="org807cd0c"><span class="section-number-3">6.1.</span> M6L1: Examples</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>Usually with time series data</li>
<li>Determine if action is needed, e.g.,
<ul class="org-ul">
<li>Time for machine maintenance?</li>
<li>Have sales increased?</li>
</ul></li>
<li>Determine impact of some past action, e.g.,
<ul class="org-ul">
<li>Did new tax / increase rate decrease sales?</li>
<li>Did price discount increase sales?</li>
</ul></li>
<li>Determine changes of current actions, e.g.
<ul class="org-ul">
<li>Did voting patterns change?</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org899d424" class="outline-3">
<h3 id="org899d424"><span class="section-number-3">6.2.</span> M6L2: Cumulative sum for change detection</h3>
<div class="outline-text-3" id="text-6-2">
<blockquote>
<p>
Answers whether mean of the observed distribution gone above a critical level
</p>
</blockquote>
<ul class="org-ul">
<li>x<sub>t</sub> is observed value at time \(t\)</li>
<li>&mu; is mean of \(x\), if no change in distribution</li>
<li>Hence, \((x_t - \mu)\) is how much the observation is above mean at time \(t\)</li>
<li>Detecting an increase
\[
  S_t = \text{max}\{ 0, s_{t-1}+(x_t-\mu-C) \}
  \]
<ul class="org-ul">
<li>Determine threshold \(T\) and ask whether S<sub>t</sub> ⩾ T?
<ul class="org-ul">
<li>If running total &lt; 0, it's irrelevant</li>
<li>There should still be some randomness</li>
<li>C is a term to control how faster S<sub>t</sub> increases</li>
</ul></li>
</ul></li>
<li>Detecting a decrease
\[
  S_t = \text{max}\{ 0, s_{t-1}+(\mu-x_t-C) \}
  \]
<ul class="org-ul">
<li>Is S<sub>t</sub> ⩾ T?</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org2e8e92a" class="outline-4">
<h4 id="org2e8e92a"><span class="section-number-4">6.2.1.</span> Interpretation</h4>
<div class="outline-text-4" id="text-6-2-1">
<ul class="org-ul">
<li>Choices of model parameters
<dl class="org-dl">
<dt>T</dt><dd>the threshold, above which alarm is raised</dd>
<dt>C</dt><dd>the control term (smaller = more sensitive)</dd>
</dl></li>
<li>Consider / trade off:
<ol class="org-ol">
<li>How costly is it to delay detection? (false negative) -&gt; if it's costly, use small C</li>
<li>How costly is false positive? -&gt; if it's costly, use big C</li>
</ol></li>
<li>Use a control chart and plot S<sub>t</sub> vs t with \(T\) as a horizontal line
<img src="./img/06-control-chart.png" alt="06-control-chart.png" /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org4a43af4" class="outline-3">
<h3 id="org4a43af4"><span class="section-number-3">6.3.</span> M6L3: Ethics: Honestly reporting our results</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>Be faithful to data</li>
<li>Have sound conclusions drawn from the model and not your own conceptions</li>
<li>Always be honest and true to your analysis</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org5091500" class="outline-2">
<h2 id="org5091500"><span class="section-number-2">7.</span> Module 07: Time series</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org11736e3" class="outline-3">
<h3 id="org11736e3"><span class="section-number-3">7.1.</span> M7L1: Introduction to exponential smoothing</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>Data for the same response is known for many time periods</li>
<li>Examples:
<ul class="org-ul">
<li>Temperature readings</li>
<li>Price of stocks</li>
<li>Daily sales of hamburgers</li>
<li>Blood pressure readings</li>
</ul></li>
<li>Variation in time series data:
<ol class="org-ol">
<li>Trends increase or decrease</li>
<li>Cyclical variables over a year or a week</li>
</ol></li>
</ul>
</div>
<div id="outline-container-org0741cbd" class="outline-4">
<h4 id="org0741cbd"><span class="section-number-4">7.1.1.</span> Random variation</h4>
<div class="outline-text-4" id="text-7-1-1">
<ul class="org-ul">
<li>No underlying reason for the variation</li>
</ul>
</div>
</div>
<div id="outline-container-org53ba9a0" class="outline-4">
<h4 id="org53ba9a0"><span class="section-number-4">7.1.2.</span> Definitions:</h4>
<div class="outline-text-4" id="text-7-1-2">
<ul class="org-ul">
<li>\(S_t\): expected <b>baseline</b> response at time period \(t\)</li>
<li>\(x_t\): the observed response at \(t\)</li>
<li>Seeing a increase over time, is it
<ol class="org-ol">
<li>A real increase?</li>
<li>Random?</li>
</ol></li>
<li>There are two ways to answer:
<ol class="org-ol">
<li>It's a real increase, hence \(S_t = x_t\)
<ul class="org-ul">
<li>the observed reading is real indicator of revised baseline</li>
</ul></li>
<li>It's random, hence \(S_t = S_{t-1}\)
<ul class="org-ul">
<li>today's baseline = yesterday's baseline</li>
</ul></li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org2a635f2" class="outline-4">
<h4 id="org2a635f2"><span class="section-number-4">7.1.3.</span> Exponential smoothing method</h4>
<div class="outline-text-4" id="text-7-1-3">
<p>
Combines both, i.e.
\(S_t = \alpha x_t + (1-\alpha)S_{t-1}\)
</p>
<ul class="org-ul">
<li><p>
0 &lt; &alpha; &lt;1
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&alpha;</th>
<th scope="col" class="org-left">example value of &alpha;</th>
<th scope="col" class="org-left">randomness</th>
<th scope="col" class="org-left">trust</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">small</td>
<td class="org-left">&rarr; 0 (e.g. 0.01)</td>
<td class="org-left">high</td>
<td class="org-left">previous baseline i.e. \(S_{t-1}\)</td>
</tr>

<tr>
<td class="org-left">large</td>
<td class="org-left">&rarr; 1 (e.g. 0.99)</td>
<td class="org-left">low</td>
<td class="org-left">today's estimate i.e. \(x_t\)</td>
</tr>
</tbody>
</table></li>

<li>How to start? \(S_1 = x_1\)</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgfbe7010" class="outline-3">
<h3 id="orgfbe7010"><span class="section-number-3">7.2.</span> M7L2: Trend and cyclic effects</h3>
<div class="outline-text-3" id="text-7-2">
<p>
Complexities!
</p>
<ul class="org-ul">
<li>Trends, increasing or decreasing</li>
<li>Cyclical patterns, e.g. annual, weekly, daily</li>
</ul>
</div>
<div id="outline-container-orge99477b" class="outline-4">
<h4 id="orge99477b"><span class="section-number-4">7.2.1.</span> Trends</h4>
<div class="outline-text-4" id="text-7-2-1">
<ul class="org-ul">
<li>\(T_t\): the trend at time period \(t\)</li>
<li>\(S_t = \alpha x_t + (1-\alpha)(S_{t-1}+T_{t-1})\)</li>
<li>\(T_t = \beta(S_t - S_{t-1}) + (1-\beta)T_{t-1}\)</li>
<li>Initial condition: \(T_1=0\)</li>
</ul>
</div>
</div>
<div id="outline-container-org75ce53f" class="outline-4">
<h4 id="org75ce53f"><span class="section-number-4">7.2.2.</span> Cyclical patterns</h4>
<div class="outline-text-4" id="text-7-2-2">
<ul class="org-ul">
<li>Make cycles additive: behaves like trend</li>
<li>Make cycles multiplicative: more notation required
<ul class="org-ul">
<li>L = length of cycle</li>
<li>\(C_t\) = the multiplicative seasonality factor
<ul class="org-ul">
<li>This inflates or deflates the observation</li>
</ul></li>
<li>New baseline formula
\[
    S_t = \frac{\alpha x_t}{C_{t-L}} + (1-\alpha)(S_{t-1}+T_{t-1})
    \]</li>
<li>Need to use the factor from \(L\) time periods ago
<ul class="org-ul">
<li>as that's the most recent cyclic factor we have from that part of the cycle</li>
</ul></li>
<li>Update the cyclic factor in a similar way i.e.:
<ul class="org-ul">
<li>\(C_t = \gamma(x_t/S_t) + (1-\gamma)(C_{t-L})\)</li>
<li>C<sub>1</sub>, &#x2026;, C<sub>L</sub> = 1
<ul class="org-ul">
<li>meaning there's no initial cyclic effect</li>
</ul></li>
<li>If C = 1.1 on Sunday:
<ul class="org-ul">
<li>sales are higher by 10% just because it's Sunday</li>
</ul></li>
</ul></li>
<li>Initial values: first \(L\) are set to 1. Multiplying by 1 = no effect</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgbeca204" class="outline-4">
<h4 id="orgbeca204"><span class="section-number-4">7.2.3.</span> Summary</h4>
<div class="outline-text-4" id="text-7-2-3">
<ul class="org-ul">
<li>Exponential smoothing
<ul class="org-ul">
<li>Single</li>
<li>Double (with trend)</li>
<li>Triple (with trend and cyclic effects)
<ul class="org-ul">
<li>AKA Winter's method, or Holt-Winters</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org4828a5b" class="outline-3">
<h3 id="org4828a5b"><span class="section-number-3">7.3.</span> M7L3: Etymology (what the name means)</h3>
<div class="outline-text-3" id="text-7-3">
<p>
Example equation when \(\alpha = \frac{1}{2}\):
\(S_t = 0.5 x_t + 0.5 S_{t-1}\)
</p>
</div>
<ol class="org-ol">
<li><a id="org4ce6026"></a>Smoothing<br />
<div class="outline-text-5" id="text-7-3-0-1">
<ul class="org-ul">
<li>Note: when x<sub>t</sub> is high, S<sub>t</sub> is <b>not</b> as high, as \((1-\alpha)S_{t-1}\) pulls it down</li>
<li>Conversely: when x<sub>t</sub> is low, S<sub>t</sub> is <b>not</b> as low, as \((1-\alpha)S_{t-1}\) pulls it up</li>
<li>Peaks and valleys are smoothed out
<img src="./img/07-smoothed-graph.png" alt="07-smoothed-graph.png" /></li>
</ul>
</div>
</li>
<li><a id="orga1503f4"></a>Exponential<br />
<div class="outline-text-5" id="text-7-3-0-2">
<ul class="org-ul">
<li>Each \(S_{t-1}\) actually contains every previous value of x!
<ul class="org-ul">
<li>When written or expanded out, e.g.
\[
    S_t = \alpha x_t + (1-\alpha)S_{t-1}
    \]
\[
    S_{t} = \alpha x_t + (1-\alpha)[\alpha x_{t-1} + (1-\alpha)S_{t-2}]
    \]
\[
    S_{t} = \alpha x_t + (1-\alpha)\alpha x_{t-1} + (1-\alpha)^2S_{t-2}
    \]</li>
</ul></li>
<li>Each S<sub>t</sub> is weighed by (1-&alpha;) to an increasing <b>exponent</b></li>
<li>This means not only the current observation matters; instead, every past observation contributes to the current baseline estimate</li>
<li>However, more recent observations are more important as they have higher weight</li>
</ul>
</div>
</li>
</ol>
<div id="outline-container-org67666c7" class="outline-4">
<h4 id="org67666c7"><span class="section-number-4">7.3.1.</span> Summary</h4>
<div class="outline-text-4" id="text-7-3-1">
<ul class="org-ul">
<li>Exponential smoothing smooths out jumps in observed data</li>
<li>It's an exponential weighting of all past observations</li>
<li>More recent observations are more important to the current baseline estimate</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgd6466a2" class="outline-3">
<h3 id="orgd6466a2"><span class="section-number-3">7.4.</span> M7L4: Forecasting</h3>
<div class="outline-text-3" id="text-7-4">
<ul class="org-ul">
<li>Recap: \(S_t = \alpha x_t + (1-\alpha)S_{t-1}\)</li>
<li>Prediction:
<ul class="org-ul">
<li>\(S_{t+1} = \alpha x_{t+1} + (1-\alpha)S_{t}\)</li>
<li>However x<sub>t+1</sub> is unknown</li>
<li>Best guess for x<sub>t+1</sub> is \(S_t\)</li>
</ul></li>
<li>Our forecast for \(t+1\) is hence (after substituting):
\[
  F_{t+1}=\alpha S_t + (1-\alpha) S_t \\
  F_{t+1} = S_t \\
  F_{t+k} = S_t \text{when } k=1, 2, ...
  \]
<ul class="org-ul">
<li>note that forecast error becomes larger for larger \(k\)</li>
</ul></li>
<li>If including trend:
\[
  S_t = \alpha x_t + (1-\alpha)(S_{t-1}+T_{t-1}) \\
  T_t = \beta (S_t-S_{t-1})+(1-\beta)T_{t-1} \\
  F_{t+1} = S_t + T_t \\
  F_{t+k} = S_t + kT_t, k=1,2,...
  \]
<dl class="org-dl">
<dt>Best estimate of next baseline</dt><dd>the most current baseline estimate</dd>
<dt>Best estimate of the trend</dt><dd>the most current trend estimate</dd>
</dl></li>
<li>If including multiplicative seasonality:
\[
  S_t = \alpha x_t/C_{t-L} + (1-\alpha)(S_{t-1}+T_{t-1})
  F_{t+1} = (S_t+T_t)C_{(t+1)-L}
  \]
<dl class="org-dl">
<dt>Best estimate of next time period seasonal factor</dt><dd>the corresponding (lagged) seasonal factor, i.e. \(C_{t+1}=C_{t+1-L}\)</dd>
</dl></li>
<li>Finding the right &alpha;, &beta;, &gamma;: use optimization, to be covered in future
<ul class="org-ul">
<li>\(\min{(F_t-x_t)^2}\)</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org82d37f2" class="outline-3">
<h3 id="org82d37f2"><span class="section-number-3">7.5.</span> M3L5: ARIMA</h3>
<div class="outline-text-3" id="text-7-5">
<p>
AutoRegressive Integrated Moving Average.
</p>
<ul class="org-ul">
<li>ARIMA <b>theory</b> is not covered in IAM.</li>
</ul>
</div>
<div id="outline-container-org51caa03" class="outline-4">
<h4 id="org51caa03"><span class="section-number-4">7.5.1.</span> (I): Differences</h4>
<div class="outline-text-4" id="text-7-5-1">
<ul class="org-ul">
<li>Exponential smoothing assumes <b>stationary</b> data, i.e.
<ul class="org-ul">
<li>mean, variance, other measures are constant over time</li>
</ul></li>
<li>ARIMA works for data that's not stationary
<ul class="org-ul">
<li>if differences in data are stationary
<dl class="org-dl">
<dt>1st order difference D<sub>(1)</sub></dt><dd>difference of consecutive observations, i.e. \(D_{(1)t}=(x_t-x_{t-1})\)</dd>
<dt>2nd order difference D<sub>(2)</sub></dt><dd>difference of the differences i.e.
\(D_{(2)t}=(x_t-x_{t-1})-(x_{t-1}-x_{t-2})\)</dd>
<dt>d<sup>th</sup> order difference D<sub>(d)</sub></dt><dd>diff&#x2026; d times</dd>
</dl></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org5a216a8" class="outline-4">
<h4 id="org5a216a8"><span class="section-number-4">7.5.2.</span> (II): Autogression</h4>
<div class="outline-text-4" id="text-7-5-2">
<ul class="org-ul">
<li>Predicting current values based on previous period's values</li>
<li>Regression: predicting value based on other factors</li>
<li>Auto: use earlier values to predict. Only works with time series</li>
<li>When used to forecast, exponential smoothing is an order-&infin; autoregressive model
<ul class="org-ul">
<li>All previous values are used to make current prediction</li>
</ul></li>
<li>Order-p autoregressive model: S<sub>t</sub> is function of \(\{x_t, x_{t-1}, ..., x_{t-(p-1)}\}\)
<ul class="org-ul">
<li>Only go back \(p\) periods</li>
</ul></li>
<li>ARIMA: combines autoregression and differencing
<ul class="org-ul">
<li>Autoregression on the differences</li>
<li>Use \(p\) time periods of previous observations to predict \(d^{th}\) order differences</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org186febf" class="outline-4">
<h4 id="org186febf"><span class="section-number-4">7.5.3.</span> (III): Moving Average</h4>
<div class="outline-text-4" id="text-7-5-3">
<ul class="org-ul">
<li>Use previous errors &epsilon;<sub>t</sub> as predictors
<ul class="org-ul">
<li>\(\epsilon_t = (\hat{x_t}-x_t)\)</li>
</ul></li>
<li>Order-q moving average
<ul class="org-ul">
<li>go back \(q\) time periods</li>
<li>\(\epsilon_{t-1}, \epsilon_{t-2}, ..., \epsilon_{t-q}\)</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgb6daf6e" class="outline-4">
<h4 id="orgb6daf6e"><span class="section-number-4">7.5.4.</span> ARIMA model</h4>
<div class="outline-text-4" id="text-7-5-4">
<p>
ARIMA (p,d,q) model
</p>
<ul class="org-ul">
<li>\(d^{th}\) order differences</li>
<li>\(p^{th}\) order autoregression</li>
<li>\(q^{th}\) order moving average</li>
<li><a id="org782246a"></a>Equation:
\[
  D_{(d)t} = \mu + \sum^p_{i=1}\alpha_i D_{(d)t-i} - \sum^q_{i=1} \theta_i (\hat{x}_{t-i}-x_{t-i})
  \]</li>
<li>Software can find \(d, p, q\)</li>
<li>Extensions
<ol class="org-ol">
<li>Add seasonality (out of scope for IAM)</li>
<li>Specific models:
<dl class="org-dl">
<dt>ARIMA(0,0,0)</dt><dd>white noise</dd>
<dt>ARIMA(0,1,0)</dt><dd>random walk</dd>
<dt>ARIMA(p,0,0)</dt><dd>AR (autoregressive) model</dd>
<dt>ARIMA(0,0,q)</dt><dd>MA (moving avg) model</dd>
<dt>ARIMA(0,1,1)</dt><dd>basic exponential smoothing model</dd>
</dl></li>
</ol></li>
<li>Can be used for short-term forecasting
<ul class="org-ul">
<li>ARIMA is better than ES when data is more stable with fewer peaks, valleys, outliers</li>
<li>ARIMA needs 40+ historical data points to work well</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org1561490" class="outline-3">
<h3 id="org1561490"><span class="section-number-3">7.6.</span> M7L6: GARCH</h3>
<div class="outline-text-3" id="text-7-6">
<dl class="org-dl">
<dt>GARCH</dt><dd>Generalized Autoregressive Conditional Heteroskedasticity</dd>
</dl>
<p>
To estimate or forecast the variance
</p>
</div>
<div id="outline-container-org27a2a6c" class="outline-4">
<h4 id="org27a2a6c"><span class="section-number-4">7.6.1.</span> Variance</h4>
<div class="outline-text-4" id="text-7-6-1">
<ul class="org-ul">
<li>Estimates the amount of error</li>
<li>E.g. forecasting demand for trucks
<ul class="org-ul">
<li>tell you how much forecast might be higher/lower than the actual value you see (later) to plan accordingly</li>
</ul></li>
<li>In investment (portfolio optimization):
<ul class="org-ul">
<li>Balance the expected return in investment with amount of volatility.
<dl class="org-dl">
<dt>Riskier</dt><dd>higher expected return</dd>
<dt>Less risky</dt><dd>lower expected return</dd>
</dl></li>
<li>Variance is a proxy for amount of volatility or risk</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org686c36d" class="outline-4">
<h4 id="org686c36d"><span class="section-number-4">7.6.2.</span> GARCH</h4>
<div class="outline-text-4" id="text-7-6-2">
<p>
\[
\sigma^2_t = \omega + \sum^p_{i=1}\beta_i\sigma^2_{t-1}+\sum^q_{i=1} \gamma_i \epsilon^2_{t-i}
\]
It looks very similar to <a href="#org782246a">ARIMA Equation</a>, but:
<b>Differences</b>:
</p>
<dl class="org-dl">
<dt>GARCH deals with variances and squared errors</dt><dd>ARIMA deals with observations and linear errors</dd>
<dt>GARCH deals with raw variances</dt><dd>ARIMA deals with differences of variances</dd>
</dl>
</div>
</div>
<div id="outline-container-org6d3cb6b" class="outline-4">
<h4 id="org6d3cb6b"><span class="section-number-4">7.6.3.</span> Summary - three models for time series analysis</h4>
<div class="outline-text-4" id="text-7-6-3">
<ol class="org-ol">
<li>Exponential smoothing</li>
<li>ARIMA, a generalization of exponential smoothing</li>
<li>GARCH, an ARIMA-like model for analyzing variance</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-org852b758" class="outline-2">
<h2 id="org852b758"><span class="section-number-2">8.</span> Module 08: Regression</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org3e8d52c" class="outline-3">
<h3 id="org3e8d52c"><span class="section-number-3">8.1.</span> M8L1: Intro to Regression</h3>
<div class="outline-text-3" id="text-8-1">
</div>
<div id="outline-container-orgf3c6545" class="outline-4">
<h4 id="orgf3c6545"><span class="section-number-4">8.1.1.</span> What questions can regression answer?</h4>
<div class="outline-text-4" id="text-8-1-1">
<ol class="org-ol">
<li>How do systems work? (descriptive)</li>
<li>What will happen in the future? (predictive)</li>
</ol>
</div>
</div>
<div id="outline-container-orgf7c0c27" class="outline-4">
<h4 id="orgf7c0c27"><span class="section-number-4">8.1.2.</span> Simple linear regression</h4>
<div class="outline-text-4" id="text-8-1-2">
<ul class="org-ul">
<li>Linear regression with one predictor, e.g. \(y = a_0 + a_1x+1\)
<ul class="org-ul">
<li>Date point \(i\)'s prediction error
\(= y_i - \hat{y}_i -(a_0+a_1x_1)\)</li>
<li>Sum of squared errors
\(=\sum^n_{i=1}(y_i - \hat{y}_i)^2\)
\(=\sum^n_{i=1}(y_i-(a_0+a_1x_1))^2\)</li>
</ul></li>
<li>Best fit regression line
<ul class="org-ul">
<li>Minimizes sum of squared errors</li>
<li>Defined by a<sub>0</sub> and a<sub>1</sub></li>
</ul></li>
<li>Underlying math
<ul class="org-ul">
<li>Minimize convex quadratic function</li>
<li>Set partial derivatives to 0</li>
<li>Solve simultaneous equations</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org80a1c7a" class="outline-3">
<h3 id="org80a1c7a"><span class="section-number-3">8.2.</span> M8L2: Maximum Likelihood and Information Criteria</h3>
<div class="outline-text-3" id="text-8-2">
</div>
<div id="outline-container-org3611d60" class="outline-4">
<h4 id="org3611d60"><span class="section-number-4">8.2.1.</span> Likelihood</h4>
<div class="outline-text-4" id="text-8-2-1">
<ul class="org-ul">
<li>Measure the probability density of a parameter set</li>
<li id="Maximum likelihood">the parameters that give the highest probability</li>
<li>Assuming:
<ol class="org-ol">
<li>Errors are normally distributed with mean 0, variance &sigma;<sup>2</sup>, independently and identically distributed</li>
<li>Observations are z<sub>1</sub> to z<sub>n</sub></li>
<li>Model estimates are y<sub>1</sub> to y<sub>n</sub></li>
</ol></li>
<li>Probability density of observing z<sub>i</sub> if true value y<sub>i</sub> is
\[
  \frac{1}{\sigma\sqrt(2\pi)}e^-\frac{(z_u-y_i)^2}{2\sigma^2}
  \]</li>
<li>Joint density over \(n\) terms
\[
  \prod^n_{i=1}\frac{1}{\sigma\sqrt(2\pi)}e^-\frac{(z_u-y_i)^2}{2\sigma^2} \\
  = (\frac{1}{\sigma\sqrt{2\pi}})^n e^-\frac{1}{2\sigma^2}\sum^n_{i=1}(z_i-y_i)^2
  \]</li>
<li>Hence <b>to minimize</b> \(\sum^n_{i=1}(z_i-y_i)^2\) over a<sub>0</sub>, &#x2026;, a<sub>m</sub>:
equals to minimizing \(\sum^n_{i=1}(z_i-(a_0 + \sum^m_{j=1}a_jx_{ij}))^2\)</li>
</ul>
</div>
</div>
<div id="outline-container-org1824c64" class="outline-4">
<h4 id="org1824c64"><span class="section-number-4">8.2.2.</span> Maximum likelihood fitting</h4>
<div class="outline-text-4" id="text-8-2-2">
<ul class="org-ul">
<li>Simplest example is regression with i.i.d. errors</li>
<li>Complex examples:
<ul class="org-ul">
<li>Different estimation formulas</li>
<li>Different error assumptions</li>
</ul></li>
<li>Good software can handle complex cases</li>
</ul>
</div>
</div>
<div id="outline-container-org94ce709" class="outline-4">
<h4 id="org94ce709"><span class="section-number-4">8.2.3.</span> Akaike Information Criterion</h4>
<div class="outline-text-4" id="text-8-2-3">
<dl class="org-dl">
<dt>L<sup>*</sup></dt><dd>maximum likelihood value</dd>
<dt>\(k\)</dt><dd>number of parameters being estimated</dd>
<dt>AIC</dt><dd>\(2k-2\log(L^{*})\)</dd>
<dt>Penalty term</dt><dd>balances likelihood with simplicity, helps avoid overfitting</dd>
</dl>
</div>
<ol class="org-ol">
<li><a id="org79f5d1c"></a>For simple regression<br />
<div class="outline-text-5" id="text-8-2-3-1">
<dl class="org-dl">
<dt>AIC</dt><dd>\[
  2(m+1) - 2\log(\frac{1}{\sigma\sqrt(2\pi)}^ne^{-\frac{1}{2\sigma^2}}\sum^n_{i=1}(z_i-(a_0 + \sum^m_{j=1}a_jx_{ij}))^2)
  \]</dd>
<dt>Preference</dt><dd>smaller AIC models</dd>
<dt>Requires</dt><dd>infinitely many data points</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="outline-container-org9125ff0" class="outline-4">
<h4 id="org9125ff0"><span class="section-number-4">8.2.4.</span> Corrected AIC (AIC<sub>c</sub>)</h4>
<div class="outline-text-4" id="text-8-2-4">
<p>
Use for smaller datasets.
\[
AIC_c = AIC + \frac{2k(k+1)}{n-k-1} \\
= 2k-2\log(L^{*})+\frac{2k(k+1)}{n-k-1}
\]
</p>
</div>
</div>
<div id="outline-container-org5a908fd" class="outline-4">
<h4 id="org5a908fd"><span class="section-number-4">8.2.5.</span> AIC<sub>c</sub> example</h4>
<div class="outline-text-4" id="text-8-2-5">
<ul class="org-ul">
<li>Model 1: AIC 75; Model 2: AIC 80</li>
<li>Relative likelihood equals:
\[
  e^\frac{AIC_1-AIC_2}{2} \\
  = 8.2%
  \]</li>
<li>Hence, Model 2 (larger AIC) is 8.2% as likely as Model 1 to be better
<ul class="org-ul">
<li>Model 1 is probably better</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orga5e9c28" class="outline-4">
<h4 id="orga5e9c28"><span class="section-number-4">8.2.6.</span> Bayesian Information Criterion</h4>
<div class="outline-text-4" id="text-8-2-6">
<ul class="org-ul">
<li>BIC:
\[
  k\log(n)-2\log(L^{*})
  \]</li>
<li>Similar to AIC, but
<ul class="org-ul">
<li>bigger penalty term than AIC's penalty term</li>
<li>encourages models with fewer parameters</li>
</ul></li>
<li>Use BIC when there are <b>more data points</b> than parameters</li>
<li><p>
Rule of thumb for |BIC<sub>1</sub> - BIC<sub>2</sub>|
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">value</th>
<th scope="col" class="org-left">interpretation for smaller BIC model</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&gt;10</td>
<td class="org-left">very likely better</td>
</tr>

<tr>
<td class="org-right">6-10</td>
<td class="org-left">likely better</td>
</tr>

<tr>
<td class="org-right">2-6</td>
<td class="org-left">somewhat likely better</td>
</tr>

<tr>
<td class="org-right">0-2</td>
<td class="org-left">slightly likely better</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>
<div id="outline-container-orgedff5cb" class="outline-4">
<h4 id="orgedff5cb"><span class="section-number-4">8.2.7.</span> Summary</h4>
<div class="outline-text-4" id="text-8-2-7">
<ul class="org-ul">
<li>No definite rules for AIC, BIC, maximum likelihood</li>
<li>Can look at all 3 to decide what's best</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgab9880b" class="outline-3">
<h3 id="orgab9880b"><span class="section-number-3">8.3.</span> M8L3: Using Regression</h3>
<div class="outline-text-3" id="text-8-3">
</div>
<div id="outline-container-org48a5fb6" class="outline-4">
<h4 id="org48a5fb6"><span class="section-number-4">8.3.1.</span> Regression coefficients</h4>
<div class="outline-text-4" id="text-8-3-1">
<ul class="org-ul">
<li>a<sub>0</sub>, a<sub>1</sub>, &#x2026;, a<sub>m</sub> for the equation:</li>
<li>\(y=a_0+a_1x_1+...+a_mx_m\)</li>
<li>Example for baseball, descriptive question:
<ul class="org-ul">
<li>How many runs is associated with every homerun</li>
<li>Response: how many runs are scored by a team</li>
<li>Predictors:
<ol class="org-ol">
<li>Number of HR</li>
<li>Triples</li>
<li>Doubles</li>
<li>Singles</li>
<li>Outs</li>
<li>Double Plays</li>
<li>Stolen bases, etc</li>
</ol></li>
<li>Equation:
\[
    \text{Runs scored} = a_0 + a_1\text{Number of HR} + a_2\text{Number of triples} + ... + a_7\text{Number of stolen bases}
    \]</li>
<li>a<sub>1</sub> = 1.4
<ul class="org-ul">
<li>Means that every HR adds 1.4 runs scored on average, ceteris paribus</li>
</ul></li>
</ul></li>
<li>Example: height, predictive question:
<ul class="org-ul">
<li>How tall will a 2-year old be as an adult?</li>
<li>Response: a person's adult height</li>
<li>Predictors:
<ol class="org-ol">
<li>Father's height</li>
<li>Mother's height</li>
<li>Height at age 2</li>
<li>Male, female</li>
</ol></li>
<li>Equation:
\[
    \text{Adult height} = a_0 + a_1\text{Father's height} + a_2 \text{Mother's height} + ... + a_4\text{Male or female}
    \]</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb8ab702" class="outline-3">
<h3 id="orgb8ab702"><span class="section-number-3">8.4.</span> M8L4: Causation vs Correlation</h3>
<div class="outline-text-3" id="text-8-4">
<dl class="org-dl">
<dt>Causation</dt><dd>one thing causes another thing</dd>
<dt>Correlation</dt><dd>two things tend to happen / not happen together, but neither one causes the other</dd>
</dl>
</div>
<div id="outline-container-org553fab2" class="outline-4">
<h4 id="org553fab2"><span class="section-number-4">8.4.1.</span> Example: winter recreation</h4>
<div class="outline-text-4" id="text-8-4-1">
<ul class="org-ul">
<li>y: hours per day spent outdoors in winter</li>
<li>x<sub>1</sub>: city's average daily winter temperature</li>
<li>Equation: \(y=a_0+a_1x_1\)</li>
<li>Correlation between y and x<sub>1</sub>
<ul class="org-ul">
<li>with low p-value of a<sub>1</sub></li>
</ul></li>
<li>Does higher temperature in winter cause people to go outside?
<ul class="org-ul">
<li>Probably</li>
</ul></li>
<li>Reversing the equation:
<ul class="org-ul">
<li>y: hours per day spent outdoors in winter</li>
<li>x<sub>1</sub>: city's average daily winter temperature</li>
<li>Equation: \(x_1 = b_0 + b_1y\)</li>
<li>Same correlation between y, x<sub>1</sub>
<ul class="org-ul">
<li>Same p-value of b<sub>1</sub> and a<sub>1</sub></li>
</ul></li>
<li>Hence, does spending more time outside <b>cause</b> higher winter temperatures?
<ul class="org-ul">
<li>No</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org23014f0" class="outline-4">
<h4 id="org23014f0"><span class="section-number-4">8.4.2.</span> Example: tiredness vs scruffiness</h4>
<div class="outline-text-4" id="text-8-4-2">
<ul class="org-ul">
<li>Neither one caused another, they're just related to a common tired factor, kids</li>
</ul>
</div>
</div>
<div id="outline-container-orgab8bcab" class="outline-4">
<h4 id="orgab8bcab"><span class="section-number-4">8.4.3.</span> How to tell causation?</h4>
<div class="outline-text-4" id="text-8-4-3">
<ul class="org-ul">
<li>When is there causation?
<ol class="org-ol">
<li>Cause before effect</li>
<li>Idea of causation makes sense</li>
<li>No outside factors can cause the relationship (hard to ensure this - need to consider <b>all</b> other factors)</li>
</ol></li>
<li>Be careful before claiming causation</li>
</ul>
</div>
</div>
<div id="outline-container-org9656270" class="outline-4">
<h4 id="org9656270"><span class="section-number-4">8.4.4.</span> Meaningless correlations</h4>
<div class="outline-text-4" id="text-8-4-4">
<ul class="org-ul">
<li>Per capita consumption of mozzarella with number of civil engineering doctorates awarded</li>
<li><a href="http://tylervigen.com/spurious-correlations">link</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org31ffa65" class="outline-3">
<h3 id="org31ffa65"><span class="section-number-3">8.5.</span> M8L5: Transformations and Interactions</h3>
<div class="outline-text-3" id="text-8-5">
<ul class="org-ul">
<li>Recall: \(y=a_0+a_1x_1+...+a_mx_m\)</li>
<li>What if the fit isn't linear for x?</li>
<li>Answer: transforming the data!</li>
</ul>
</div>
<div id="outline-container-orgfe7a8f2" class="outline-4">
<h4 id="orgfe7a8f2"><span class="section-number-4">8.5.1.</span> Transforming the data</h4>
<div class="outline-text-4" id="text-8-5-1">
<ul class="org-ul">
<li>Quadratic regression, e.g.
\[
  y = a_0 + a_1 x_1 + a_2 x_1^2
  \]</li>
<li>Trigonometric:
\[
  y = a_0 + a_2 \sin(x^2)
  \]</li>
<li>Response transform:
\[
  \log(y) = a_0 + a_1 x_1 + ... + a_m x_m
  \]</li>
<li>etc.</li>
<li>Box-Cox transforms can be automated</li>
</ul>
</div>
</div>
<div id="outline-container-org30972f6" class="outline-4">
<h4 id="org30972f6"><span class="section-number-4">8.5.2.</span> Interaction terms, e.g. product of inputs</h4>
<div class="outline-text-4" id="text-8-5-2">
<ul class="org-ul">
<li>Child's heights might be influenced by <b>product</b> of father and mother's heights (\(x_1x_2\))</li>
<li>\(y = a_0 + a_1 x_1 + a_2 x_2 + a_3 (x_1 x_2)\)</li>
<li><b>Treat x<sub>1</sub> x<sub>2</sub> as new input, x<sub>3</sub></b></li>
<li>Then find best fit coefficients in the last module</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org9291348" class="outline-3">
<h3 id="org9291348"><span class="section-number-3">8.6.</span> M6L6: Output</h3>
<div class="outline-text-3" id="text-8-6">
</div>
<div id="outline-container-org2164bf8" class="outline-4">
<h4 id="org2164bf8"><span class="section-number-4">8.6.1.</span> p-Values</h4>
<div class="outline-text-4" id="text-8-6-1">
<ul class="org-ul">
<li>Estimates the <b>probability</b> that coefficient is actually 0
<ul class="org-ul">
<li>A hypothesis test</li>
</ul></li>
<li>If p-value is big (&gt;0.05), the coefficient is likely 0, hence remove its attribute from the model</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="orga81e1f5"></a>Other thresholds<br />
<div class="outline-text-5" id="text-8-6-1-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Threshold</th>
<th scope="col" class="org-left">Number of factors included</th>
<th scope="col" class="org-left">Risk</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Higher (&gt;0.05)</td>
<td class="org-left">More factors included</td>
<td class="org-left">Irrelevant factors included</td>
</tr>

<tr>
<td class="org-left">Lower (&lt;0.05)</td>
<td class="org-left">Less factors included</td>
<td class="org-left">Relevant factors left out</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><a id="orge2c188e"></a>Warnings<br />
<div class="outline-text-5" id="text-8-6-1-2">
<ul class="org-ul">
<li>With lots of data:
<ul class="org-ul">
<li>p-values can get small and seem significant even when attributes aren't related to response</li>
</ul></li>
<li>Even when meaningful, p-values only represent <b>probabilities</b>
<ol class="org-ol">
<li>With 100 attributes having p-value 0.02:</li>
<li>Each of them have 2% chance of <b>not</b> being significant</li>
<li>Hence on average 2/100 are actually irrelevant</li>
</ol></li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgc9a43f7" class="outline-4">
<h4 id="orgc9a43f7"><span class="section-number-4">8.6.2.</span> Confidence interval</h4>
<div class="outline-text-4" id="text-8-6-2">
<ul class="org-ul">
<li>Mostly given at 95% level around the coefficient</li>
<li>Range of where the coefficient probably lies</li>
<li>And how close that is to zero</li>
<li>Related to p-value</li>
</ul>
</div>
</div>
<div id="outline-container-org8930f8e" class="outline-4">
<h4 id="org8930f8e"><span class="section-number-4">8.6.3.</span> T-statistic</h4>
<div class="outline-text-4" id="text-8-6-3">
<ul class="org-ul">
<li>\(\frac{\text{Coefficient}}{\text{Std error}}\)</li>
<li>Related to p-value</li>
</ul>
</div>
</div>
<div id="outline-container-org50d32f6" class="outline-4">
<h4 id="org50d32f6"><span class="section-number-4">8.6.4.</span> Coefficient itself</h4>
<div class="outline-text-4" id="text-8-6-4">
<ul class="org-ul">
<li>If very small, then when multiplied by attribute, it's likely irrelevant</li>
</ul>
</div>
</div>
<div id="outline-container-org1e5c4ca" class="outline-4">
<h4 id="org1e5c4ca"><span class="section-number-4">8.6.5.</span> \(R^2\)</h4>
<div class="outline-text-4" id="text-8-6-5">
<ul class="org-ul">
<li>Estimate of how much variability can be explained by the model</li>
<li>E.g. R<sup>2</sup> = 0.59:
<ul class="org-ul">
<li>0.59 of data variability can be explained by the model</li>
<li>remaining 0.41 is either:
<ul class="org-ul">
<li>random variation</li>
<li>or other factors</li>
</ul></li>
</ul></li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org75c2379"></a>Adjusted \(R^2\)<br />
<div class="outline-text-5" id="text-8-6-5-1">
<ul class="org-ul">
<li>Accounts for (penalizes) the number of attributes used</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgbdb3413" class="outline-2">
<h2 id="orgbdb3413"><span class="section-number-2">9.</span> Module 09: Advanced Data Preparation</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org121fa0d" class="outline-3">
<h3 id="org121fa0d"><span class="section-number-3">9.1.</span> M9L1: Box-Cox Transformations</h3>
<div class="outline-text-3" id="text-9-1">
<ul class="org-ul">
<li>Models may require data to be normally distributed</li>
<li>What happens when this assumption isn't valid in the data?
<ul class="org-ul">
<li>Results will have bias in this case</li>
<li>Data exhibits heteroskedasicity</li>
<li>i.e., variances are not i.i.d.</li>
</ul></li>
<li>Another example is time series data, where later values have higher variance</li>
<li>Box-Cox is a logarithmic transformation that:
<ol class="org-ol">
<li>Stretches smaller range to increase variability</li>
<li>Shrinks larger range to reduce variability</li>
</ol></li>
<li>E.g. \(t(y)=\frac{y^\lambda-a}{\lambda}\)
<ul class="org-ul">
<li>t(y) can become close to normally distributed</li>
</ul></li>
<li>Need to remember to check for normality (e.g., with Normal Q-Q plot)</li>
</ul>
</div>
</div>
<div id="outline-container-orgcb38487" class="outline-3">
<h3 id="orgcb38487"><span class="section-number-3">9.2.</span> M9L2: Detrending</h3>
<div class="outline-text-3" id="text-9-2">
<ul class="org-ul">
<li>For time series data with trends, i.e. an increase or decrease over time
<ul class="org-ul">
<li>For example: increase in price of gold over time but need to account for inflation over time (value of $ decreases over time)</li>
<li>The trend if not correct can mess up a factor-based analysis</li>
<li>Can detrend:
<ul class="org-ul">
<li>Response</li>
<li>Predictors</li>
<li>Factor-based model (consider whenever using these models)
<ul class="org-ul">
<li>Regression, SVM, etc.</li>
</ul></li>
</ul></li>
</ul></li>
<li>How to detrend:
<ul class="org-ul">
<li>Factor by factor for one-dimensional regression, y=a<sub>0</sub>+a<sub>1x</sub>
<ul class="org-ul">
<li>Simple, works well to remove trend for factor-based analysis</li>
<li>This requires going factor by factor and fitting a linear regression model on it</li>
<li>E.g. for simple linear regression for gold prices:
<ul class="org-ul">
<li>Price = - 45600 + 23.2xYear</li>
<li>Detrend end price = Actual price -(-45600+23.2+year)</li>
<li>This produces a similar graph to the inflation-adjusted rate</li>
<li>Useful when we don’t know the response (as in most cases)</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgc49d8f9" class="outline-3">
<h3 id="orgc49d8f9"><span class="section-number-3">9.3.</span> M9L3: Intro to PCA</h3>
<div class="outline-text-3" id="text-9-3">
<ul class="org-ul">
<li>Works on high dimensional and correlated data
<ul class="org-ul">
<li>Which subset of features are important to predict response?</li>
<li>e.g. which stocks can predict how well the market performs the next day?
<ul class="org-ul">
<li>6K securities</li>
<li>Remove days that have major events</li>
</ul></li>
<li>Issues:
<ul class="org-ul">
<li>6K predictors need many many data points to avoid overfitting (need to reduce predictors)
<ul class="org-ul">
<li>However, even with unlimited data, the underlying situation could have changed over time</li>
<li>E.g. TSLA stock is good predictor now but it was only listed 5 years ago</li>
</ul></li>
<li>High correlation between predictors</li>
</ul></li>
</ul></li>
<li>PCA transforms data by:
<ul class="org-ul">
<li>Removing correlations within predictors</li>
<li>Ranking coordinates by importance
<ul class="org-ul">
<li>Most important are first</li>
</ul></li>
<li>By concentrating on first <b>n</b> principal components
<ul class="org-ul">
<li>This reduces random effects and</li>
<li>These PCs have higher signal to noise ratio</li>
</ul></li>
<li>Graphically:
<ul class="org-ul">
<li>rotate plot until it’s orthogonal to the correlation</li>
</ul></li>
<li>If D1 and D2 are the new PCs,
<ul class="org-ul">
<li>D1 (that explains more variance) will be the first factor</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgfb07c68" class="outline-3">
<h3 id="orgfb07c68"><span class="section-number-3">9.4.</span> M9L4: Using PCA</h3>
<div class="outline-text-3" id="text-9-4">
</div>
<div id="outline-container-org176e5dc" class="outline-4">
<h4 id="org176e5dc"><span class="section-number-4">9.4.1.</span> Math of PCA</h4>
<div class="outline-text-4" id="text-9-4-1">
<ul class="org-ul">
<li>Definitions
<dl class="org-dl">
<dt>\(X\)</dt><dd>initial matrix of data</dd>
<dt>\(x_{ij}\)</dt><dd>j<sup>th</sup> factor of i<sup>th</sup> data point</dd>
<dt>Scale to:</dt><dd>\(\frac{1}{m}\sum_i x_{ij} = \mu_j = 0\)</dd>
</dl></li>
<li>To find all eigenvectors of X<sup>T</sup> X, where:
<dl class="org-dl">
<dt>V</dt><dd>Matrix of eigenvectors, sorted by eigenvalue</dd>
<dt>V</dt><dd>[V<sub>1</sub> V<sub>2</sub> &#x2026; ]</dd>
<dt>V<sub>j</sub></dt><dd>j<sup>th</sup> eigenvector of X<sup>T</sup> X</dd>
</dl></li>
<li>PCA is a linear combination:
<ul class="org-ul">
<li>1st component is XV<sub>1</sub>, then 2nd is XV<sub>2</sub>, &#x2026;</li>
<li>k<sup>th</sup> new factor for i<sup>th</sup> data point:
\[
    t_{ik} = \sum^m_{ik} x_{ij}v_{jk}
    \]</li>
<li>t<sub>ik</sub> is the factor after PCA</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgaeb617f" class="outline-4">
<h4 id="orgaeb617f"><span class="section-number-4">9.4.2.</span> PCA as linear combination</h4>
<div class="outline-text-4" id="text-9-4-2">
<ul class="org-ul">
<li>It <b><b>removes</b></b> correlation between factors</li>
<li>In order to have fewer variables/factors in the model:
<ul class="org-ul">
<li>Choose to include only first <i>n</i> principal components</li>
</ul></li>
<li>PCA can also deal with non-linear functions, using kernels. This is similar to SVM modeling</li>
</ul>
</div>
</div>
<div id="outline-container-orgd20459a" class="outline-4">
<h4 id="orgd20459a"><span class="section-number-4">9.4.3.</span> PCA for regression</h4>
<div class="outline-text-4" id="text-9-4-3">
<ul class="org-ul">
<li>How to interpret the new model in terms of original factors?</li>
<li>Example: PCA finds \(L\) new factors (each \(t_{ik}\)), and regression coefficients b<sub>0</sub>, b<sub>1</sub>, &#x2026; b<sub>L</sub>:
\[
  y_i = b_0 + \sum^L_{k=1}b_k t_{ik} \\
  = b_0 + \sum^L_{k=1}b_k [\sum^m_{j=1} x_{ij} v{jk}] \\
  = b_0 + \sum^m_{j=1}x_{ij} [\sum^L_{k=1}b_kv_{jk}]
  \\
  = b_0 + \sum^m_{j=1}x_{ij}[a_j]
  \]</li>
<li>Each t vector does not have nice intuitive explanations as they are linear combinations of original factors.</li>
<li>Hence just plug in the transformation for each t factor:
\[
  a_j = \sum^L_{k=1}b_kv_{jk}
  \]</li>
</ul>
</div>
</div>
<div id="outline-container-org18aaee3" class="outline-4">
<h4 id="org18aaee3"><span class="section-number-4">9.4.4.</span> Summary of PCA</h4>
<div class="outline-text-4" id="text-9-4-4">
<ul class="org-ul">
<li>Use PCA for high-dimensional and correlated data</li>
<li>PCA removes these correlations and ranks coordinates by importance (i.e., variability explained)
<ul class="org-ul">
<li>PC1 &gt; PC2 &gt; PC3, etc</li>
</ul></li>
<li>PCA can be transformed back to the original factor space to get intuitive explanations</li>
<li>PCA allows use of fewer variables
<ul class="org-ul">
<li>Pick the ones that explain the most variability</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8f6db18" class="outline-3">
<h3 id="org8f6db18"><span class="section-number-3">9.5.</span> M9L5: Eigenvalues and Eigenvectors</h3>
<div class="outline-text-3" id="text-9-5">
</div>
<div id="outline-container-orga8be895" class="outline-4">
<h4 id="orga8be895"><span class="section-number-4">9.5.1.</span> Initial example</h4>
<div class="outline-text-4" id="text-9-5-1">
<ul class="org-ul">
<li>Definitions:
<dl class="org-dl">
<dt>\(A\)</dt><dd>a square matrix</dd>
<dt>\(v\)</dt><dd>a vector such that \(Av=\lambda v\)</dd>
<dt>\(V\)</dt><dd>eigenvector of \(A\)</dd>
<dt>\(\lambda\)</dt><dd>eigenvalue of \(A\), i.e. det(A-&lambda; I) = 0. Every &lambda; is eigenvalue of A</dd>
</dl></li>
<li>Given &lambda;, solve \(Av=\lambda v\) to find the eigenvector \(v\)</li>
</ul>
</div>
</div>
<div id="outline-container-orgbdd82ba" class="outline-4">
<h4 id="orgbdd82ba"><span class="section-number-4">9.5.2.</span> Important: know how eigenvalues and eigenvectors are important to PCA</h4>
<div class="outline-text-4" id="text-9-5-2">
<ul class="org-ul">
<li>With a scaled matrix \(X\) of data, and x<sub>ij</sub> is factor value for i<sup>th</sup> data point after scaling,</li>
<li>Find eigenvectors v<sub>1</sub> &#x2026; v<sub>n</sub> of \((X^TX)\)</li>
<li>Then, find the principal components:
<ol class="org-ol">
<li>Multiply \(X\) by the eigenvectors</li>
<li>\(Xv_1, Xv_2, ..., Xv_n\) are the principal components
<ul class="org-ul">
<li>i.e. the transformed set of orthogonal coordinate directions</li>
</ul></li>
</ol></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org3dd7448" class="outline-3">
<h3 id="org3dd7448"><span class="section-number-3">9.6.</span> M9L6: PCA: The good and the bad</h3>
<div class="outline-text-3" id="text-9-6">
<ul class="org-ul">
<li>Summary
<img src="./img/m9l6-pca-summary.png" alt="m9l6-pca-summary.png" /></li>
<li>D<sub>1</sub> has more explanatory power (vaariation)</li>
<li>But it may not be the most helpful for explanatory/predictive modeling</li>
<li><b>PCA depends only on the independent variables</b>, not the response variable
<ul class="org-ul">
<li>It's possible response is affected by variables with low variability instead of those with high variability!</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org23e96cd" class="outline-4">
<h4 id="org23e96cd"><span class="section-number-4">9.6.1.</span> Example where PCA is good</h4>
<div class="outline-text-4" id="text-9-6-1">
<ul class="org-ul">
<li>Assume PCA is used for classification</li>
<li>PC1 has most of the variance and PC1 can classify red and blue points
<img src="./img/m9l6-pca-good.png" alt="m9l6-pca-good.png" /></li>
</ul>
</div>
</div>
<div id="outline-container-orga34b61b" class="outline-4">
<h4 id="orga34b61b"><span class="section-number-4">9.6.2.</span> Example where PCA is bad</h4>
<div class="outline-text-4" id="text-9-6-2">
<ul class="org-ul">
<li>PC1, though it has more variance, cannot classify the red and blue points</li>
<li>PC2 has less variance but it can classify the points exactly
<img src="./img/m9l6-pca-bad.png" alt="m9l6-pca-bad.png" /></li>
</ul>
</div>
</div>
<div id="outline-container-org8e2610f" class="outline-4">
<h4 id="org8e2610f"><span class="section-number-4">9.6.3.</span> Summary</h4>
<div class="outline-text-4" id="text-9-6-3">
<ul class="org-ul">
<li>We still use PCA (or try to!) as dimensions have higher variation specifically because they contain more information</li>
<li>However, this is not always true</li>
<li>PCA is a helpful approach to try</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org36cde0f" class="outline-2">
<h2 id="org36cde0f"><span class="section-number-2">10.</span> Module 10: Advanced Regression</h2>
<div class="outline-text-2" id="text-10">
<blockquote>
<p>
Midterm 1 covers up to Module 10
</p>
</blockquote>
</div>
<div id="outline-container-orgfd3fe4b" class="outline-3">
<h3 id="orgfd3fe4b"><span class="section-number-3">10.1.</span> M10L01: Introduction to CART</h3>
<div class="outline-text-3" id="text-10-1">
<blockquote>
<p>
Classification and Regression Trees
</p>
</blockquote>
</div>
<div id="outline-container-orgc8119c6" class="outline-4">
<h4 id="orgc8119c6"><span class="section-number-4">10.1.1.</span> Trees in regression</h4>
<div class="outline-text-4" id="text-10-1-1">
</div>
<ol class="org-ol">
<li><a id="org03ca1b6"></a>Uses<br />
<div class="outline-text-5" id="text-10-1-1-1">
<ol class="org-ol">
<li>Classification</li>
<li>Decision tree</li>
</ol>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgabdfeaf" class="outline-4">
<h4 id="orgabdfeaf"><span class="section-number-4">10.1.2.</span> Recall</h4>
<div class="outline-text-4" id="text-10-1-2">
<p>
In simple linear regression, e.g.:
impact of marketing email on recipient spending.
</p>
<ul class="org-ul">
<li>Predictors:
<ol class="org-ol">
<li>Demographics e.g. age, sex, number of children, income</li>
<li>Purchasing factors e.g. amount spent per month</li>
<li>Binary factor e.g. was email received and opened</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgb906030" class="outline-4">
<h4 id="orgb906030"><span class="section-number-4">10.1.3.</span> What if responses can be differentiated by a factor?</h4>
<div class="outline-text-4" id="text-10-1-3">
<p>
(The above example of simple linear regression assumes every data point behaves the same way)
If each group instead have their own characteristics and responses, two regressions can thus be fitted, e.g.:
</p>
<ol class="org-ol">
<li>25 years or younger
\(\text{Money spent}=50+13.75\times\text{Number of Children}+0\times\text{Income over 30,000}+\text{...}\)</li>
<li>older than 25
\(\text{Money spent}=32+28.13\times\text{Number of children}+7.13\times\text{Income over 30,000}+\text{...}\)</li>
</ol>
</div>
</div>
<div id="outline-container-org0c8aa8f" class="outline-4">
<h4 id="org0c8aa8f"><span class="section-number-4">10.1.4.</span> Further splits are possible</h4>
<div class="outline-text-4" id="text-10-1-4">
<ul class="org-ul">
<li>Each branch is further split</li>
<li>Each ending is a <i>"leaf"</i>
<ul class="org-ul">
<li><i>Descriptively</i>: Each leaf's coefficients explains behaviour in that leaf</li>
<li><i>Predictively</i>: Each leaf's regression model can be used to predict a new point in that branch.</li>
</ul></li>
<li>Each branch can run \(R^2\) and those with low \(R^2\) can be investigated/improved.</li>
</ul>
</div>
</div>
<div id="outline-container-org0ff9388" class="outline-4">
<h4 id="org0ff9388"><span class="section-number-4">10.1.5.</span> Disadvantages</h4>
<div class="outline-text-4" id="text-10-1-5">
<ul class="org-ul">
<li>Lots of computations and regressions</li>
<li>Fewer and fewer data points in each node</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org45ad03a"></a>Hence:<br />
<div class="outline-text-5" id="text-10-1-5-1">
<p>
Simplify the regression by just using the constant term input
</p>
<ul class="org-ul">
<li>e.g. \(y=a_0\) instead of \(y=a_0+a_1x+\text{...}\)</li>
<li>This is the mean response over all data points in the node, i.e.
\[
  a_0 = \frac{\sum_i\text{in node }y_i}{\text{count of data points in node}} \\
  = \text{avg response in node}
  \]</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-org4d1b2d9" class="outline-4">
<h4 id="org4d1b2d9"><span class="section-number-4">10.1.6.</span> Other places to use trees</h4>
<div class="outline-text-4" id="text-10-1-6">
<ul class="org-ul">
<li>The branching concept can be applied to:
<ul class="org-ul">
<li>Logistic regression model
<ul class="org-ul">
<li>fraction of node's data points with True response</li>
</ul></li>
<li>Classification model
<ul class="org-ul">
<li>Most common classification among node's data points</li>
</ul></li>
<li>Decision model
<ul class="org-ul">
<li>Each leaf is the decision "do I send a marketing email?"</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org67c6b11" class="outline-4">
<h4 id="org67c6b11"><span class="section-number-4">10.1.7.</span> Common questions</h4>
<div class="outline-text-4" id="text-10-1-7">
<ol class="org-ol">
<li>How to choose the branches?</li>
<li>When to stop branching?</li>
<li>Why is this called a regression tree?</li>
</ol>
</div>
</div>
<div id="outline-container-orgb1463a9" class="outline-4">
<h4 id="orgb1463a9"><span class="section-number-4">10.1.8.</span> Etymology of "tree"</h4>
<div class="outline-text-4" id="text-10-1-8">

<div id="org7ad1974" class="figure">
<p><img src="./img/m1001-tree.png" alt="m1001-tree.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb68d34d" class="outline-3">
<h3 id="orgb68d34d"><span class="section-number-3">10.2.</span> M10L02: Branching</h3>
<div class="outline-text-3" id="text-10-2">
</div>
<div id="outline-container-org835c353" class="outline-4">
<h4 id="org835c353"><span class="section-number-4">10.2.1.</span> Main questions</h4>
<div class="outline-text-4" id="text-10-2-1">
<ol class="org-ol">
<li>Which factors are used to decide on branching?</li>
<li>How to split data?</li>
</ol>
<p>
In practice, no good algorithm to help decide. Instead, branch on 1 factor at a time.
</p>
</div>
</div>
<div id="outline-container-org9d4e0a4" class="outline-4">
<h4 id="org9d4e0a4"><span class="section-number-4">10.2.2.</span> Branching methods</h4>
<div class="outline-text-4" id="text-10-2-2">
<ol class="org-ol">
<li>Start with half of data and run a regression</li>
<li>Split the data into 2 halves based on some factor we can branch from (e.g. age &gt;25)</li>
<li>For each leaf:
<ol class="org-ol">
<li>Calculate variance of response amongst all data points in each leaf</li>
<li>Test splitting on each factor to see how much lower total variance of two branches would be vs. the least variance.</li>
<li>Choose the factor with lowest total variance.</li>
<li>Make split iif:
<ol class="org-ol">
<li>Enough data points in each branch</li>
<li>Decrease is lower than threshold &delta;</li>
</ol></li>
<li>Otherwise, don't split the leaf</li>
</ol></li>
<li>Go backwards to <b>prune</b> using the 2nd half of data not used in initial branching. For each pair of leaves created in each branch:
<ol class="org-ol">
<li>Use the other half of data in each branch to see if estimation error was improved by branching
<ol class="org-ol">
<li>If error increases/no change, then remove branch</li>
<li>Else, keep the branch</li>
</ol></li>
</ol></li>
</ol>
</div>
</div>
<div id="outline-container-orgc41caee" class="outline-4">
<h4 id="orgc41caee"><span class="section-number-4">10.2.3.</span> Generic branching concept</h4>
<div class="outline-text-4" id="text-10-2-3">
<blockquote>
<p>
Overfitting can be costly; make sure the benefit of each branch is greater than its cost
</p>
</blockquote>
<p>
Key ideas
</p>
<ol class="org-ol">
<li>Use a metric related to model quality</li>
<li>Find 'best factor' to branch with</li>
<li><b>Check</b>: did this improve the model?
<ol class="org-ol">
<li>If not, prune the branch back.</li>
</ol></li>
</ol>
<p>
Rejecting potential branches
</p>
<ol class="org-ol">
<li>Low improvement benefit</li>
<li>Some side of branch has too few data points after branching
<ol class="org-ol">
<li>Each leaf should contain &ge;5% of original data (we don't want to over-fit the model)</li>
</ol></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orga42c8b8" class="outline-3">
<h3 id="orga42c8b8"><span class="section-number-3">10.3.</span> M10L03: Random Forests</h3>
<div class="outline-text-3" id="text-10-3">
</div>
<div id="outline-container-org1a88515" class="outline-4">
<h4 id="org1a88515"><span class="section-number-4">10.3.1.</span> Intro summary</h4>
<div class="outline-text-4" id="text-10-3-1">
<ul class="org-ul">
<li>Introduce randomness</li>
<li>Generate lots of random trees
<ul class="org-ul">
<li>Each has its strengths and weaknesses</li>
</ul></li>
<li>Key concept: average better than single tree</li>
</ul>
</div>
</div>
<div id="outline-container-org0425c47" class="outline-4">
<h4 id="org0425c47"><span class="section-number-4">10.3.2.</span> Introducing randomness</h4>
<div class="outline-text-4" id="text-10-3-2">
<blockquote>
<p>
via bootstrapping
</p>
</blockquote>
<ul class="org-ul">
<li>With \(n\) number of original data points, we make trees each with \(n\) points.
<ul class="org-ul">
<li>However, some points can be picked multiple times while others get picked 0 times.</li>
</ul></li>
<li>When branching:
<ul class="org-ul">
<li>Not as before (before: we choose 1 factor at a time)</li>
<li>In RF: pick a small number of factors \(X\)</li>
<li>Choose the best factor in that set to branch on</li>
<li>Common number of factors used: \(1+\log(n)\)</li>
</ul></li>
<li>No need to prune tree</li>
</ul>
</div>
</div>
<div id="outline-container-org6b5c5bb" class="outline-4">
<h4 id="org6b5c5bb"><span class="section-number-4">10.3.3.</span> Note</h4>
<div class="outline-text-4" id="text-10-3-3">
<ul class="org-ul">
<li>Each tree has slightly different data</li>
<li>Will end up with lots of different trees (500-1000 are common)</li>
<li>Each tree gives a slightly different regression model</li>
<li>Which one to use?
<ul class="org-ul">
<li>Regression trees: use the <b>average</b> predicted response</li>
<li>Classification trees: use the <b>most common</b> predicted response</li>
</ul></li>
<li>Benefits of RF:
<ul class="org-ul">
<li>Better overall estimate</li>
<li>Average between tree can somewhat address over-fitting</li>
</ul></li>
<li>Disadvantages of RF:
<ul class="org-ul">
<li>Harder to explain and interpret results</li>
<li>Cannot explain how variables interact, or how some sequence of branches is helpful/meaningful (which can be found in single tree)</li>
<li>Can't give specific model from the data</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgdc41935" class="outline-4">
<h4 id="orgdc41935"><span class="section-number-4">10.3.4.</span> Summary of RF</h4>
<div class="outline-text-4" id="text-10-3-4">
<ul class="org-ul">
<li>Method: introduce randomness into the trees</li>
<li>Good as 'black box' predictor</li>
<li>Cannot give much detailed insight</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8552088" class="outline-3">
<h3 id="org8552088"><span class="section-number-3">10.4.</span> M10L04: Explainability and Interpretability</h3>
<div class="outline-text-3" id="text-10-4">
<blockquote>
<p>
How easy or not it is to understand how models create their output?
</p>
</blockquote>
</div>
<div id="outline-container-org2ef9510" class="outline-4">
<h4 id="org2ef9510"><span class="section-number-4">10.4.1.</span> Example: linear regression</h4>
<div class="outline-text-4" id="text-10-4-1">
<p>
\[y=a_0 + \sum^n_{j=1}a_j x_{ij}\]
To answer "how is the value of \(y\) affected by different values of the predictor?" with:
</p>
<dl class="org-dl">
<dt>y</dt><dd>Number of tickets sold this year</dd>
<dt>x<sub>1</sub></dt><dd>Salary of top 4 stars</dd>
<dt>x<sub>2</sub></dt><dd>Number of movies with similar plots this year</dd>
<dt>x<sub>3</sub></dt><dd>Rated <b>R</b> or more restrictive (1=yes)</dd>
<dt>x<sub>4</sub></dt><dd>Number of days left in the year</dd>
<dt>a<sub>0</sub></dt><dd>1,000,000</dd>
<dt>a<sub>1</sub></dt><dd>0.25</dd>
<dt>a<sub>2</sub></dt><dd>-1,000,000</dd>
<dt>a<sub>3</sub></dt><dd>-1,000,000</dd>
<dt>a<sub>4</sub></dt><dd>20,000</dd>
</dl>
<p>
The interpretation is thus:
</p>
<ul class="org-ul">
<li>Baseline is 1,000,000 tickets (a<sub>0</sub>)</li>
<li>Salary of star, each dollar increases number of tickets sold by $0.25 (a<sub>1</sub>)</li>
<li>Similar movie: each similar movie decreases number of tickets sold by 1,000,000 (a<sub>2</sub>)</li>
<li>Restrictive rating: decreases number of tickets sold by 1,000,000</li>
<li>Days left in year: each day increases number of tickets sold by 20,000</li>
</ul>
</div>
</div>
<div id="outline-container-org539bd50" class="outline-4">
<h4 id="org539bd50"><span class="section-number-4">10.4.2.</span> Example: regression tree</h4>
<div class="outline-text-4" id="text-10-4-2">
<ul class="org-ul">
<li>With the same values above, it becomes a long if<sub>else</sub> statement</li>
<li>Can describe detail of tree but it's not helpful for understanding</li>
</ul>
</div>
</div>
<div id="outline-container-org326816d" class="outline-4">
<h4 id="org326816d"><span class="section-number-4">10.4.3.</span> Example: random forests</h4>
<div class="outline-text-4" id="text-10-4-3">
<ul class="org-ul">
<li>If one tree is hard to explain, 500 are even worse</li>
<li>Although random forests give relative branching importance of each variable,
<ul class="org-ul">
<li>They do not say <b>how</b></li>
<li>Hence RF are not precise for interpretability or explainability</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org099e94a" class="outline-4">
<h4 id="org099e94a"><span class="section-number-4">10.4.4.</span> Comparisons</h4>
<div class="outline-text-4" id="text-10-4-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Model</th>
<th scope="col" class="org-left">Explainability</th>
<th scope="col" class="org-left">Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Linear regression</td>
<td class="org-left">Higher</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Regression tree</td>
<td class="org-left">Medium</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Random forest</td>
<td class="org-left">Lower</td>
<td class="org-left">Sometimes higher</td>
</tr>
</tbody>
</table>

<p>
More explainable models:
</p>
<ul class="org-ul">
<li>help us understand "why"</li>
<li>help decision makers to choose between models</li>
<li>can be a legal requirement, e.g. in finance</li>
</ul>
<p>
However, less explainable models can give better results at times as they can identify and model more complex patterns
</p>
</div>
</div>
<div id="outline-container-orge0bfa3b" class="outline-4">
<h4 id="orge0bfa3b"><span class="section-number-4">10.4.5.</span> Tradeoff</h4>
<div class="outline-text-4" id="text-10-4-5">
<p>
Pay attention to tradeoffs when proposing a model:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Explainability</th>
<th scope="col" class="org-left">Value</th>
<th scope="col" class="org-left">Adoption</th>
<th scope="col" class="org-left">Legal requirement</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Less</td>
<td class="org-left">Potentially more</td>
<td class="org-left">?</td>
<td class="org-left">?</td>
</tr>

<tr>
<td class="org-left">More</td>
<td class="org-left">?</td>
<td class="org-left">More likely</td>
<td class="org-left">Might be required</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org8de9ae7" class="outline-3">
<h3 id="org8de9ae7"><span class="section-number-3">10.5.</span> M10L05: Confusion Matrices</h3>
<div class="outline-text-3" id="text-10-5">
<blockquote>
<p>
Answers: How to measure how well a classification-type model works?
</p>
</blockquote>
<p>
This is a confusion matrix:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Model</th>
<th scope="col" class="org-left">Classification</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Yes</td>
<td class="org-left">No</td>
</tr>

<tr>
<td class="org-left">True</td>
<td class="org-left">Yes</td>
<td class="org-left">Correct</td>
<td class="org-left">Wrong</td>
</tr>

<tr>
<td class="org-left">Classification</td>
<td class="org-left">No</td>
<td class="org-left">Wrong</td>
<td class="org-left">Correct</td>
</tr>
</tbody>
</table>

<p>
It shows how much the model is confusing the two categories.
</p>
</div>
<div id="outline-container-org3b393e3" class="outline-4">
<h4 id="org3b393e3"><span class="section-number-4">10.5.1.</span> Details</h4>
<div class="outline-text-4" id="text-10-5-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Model</th>
<th scope="col" class="org-left">Classification</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Yes</td>
<td class="org-left">No</td>
</tr>

<tr>
<td class="org-left">True</td>
<td class="org-left">Yes</td>
<td class="org-left">True Pos</td>
<td class="org-left">False Neg</td>
</tr>

<tr>
<td class="org-left">Classification</td>
<td class="org-left">No</td>
<td class="org-left">False Pos</td>
<td class="org-left">True Neg</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>Positive: model <b>says</b> it's in the category</li>
<li>Negative: model <b>says</b> it's NOT in the category</li>
<li>True: model got it right</li>
<li>False: model got it wrong</li>
</ul>
</div>
</div>
<div id="outline-container-orgd784c93" class="outline-4">
<h4 id="orgd784c93"><span class="section-number-4">10.5.2.</span> Definitions</h4>
<div class="outline-text-4" id="text-10-5-2">
<dl class="org-dl">
<dt>Sensitivity</dt><dd>TP/(TP+FN), i.e. TP / All actual positives</dd>
<dt>Specificity</dt><dd>TN/(TN+FP), i.e. TN/ All actual negatives</dd>
</dl>
<p>
Others: don't memorize, just refer.
</p>
</div>
</div>
</div>
<div id="outline-container-orga9c15f4" class="outline-3">
<h3 id="orga9c15f4"><span class="section-number-3">10.6.</span> M10L06: Situationally-Driven Comparisons</h3>
<div class="outline-text-3" id="text-10-6">
</div>
<div id="outline-container-orgca40bf9" class="outline-4">
<h4 id="orgca40bf9"><span class="section-number-4">10.6.1.</span> Example: from spam detection</h4>
<div class="outline-text-4" id="text-10-6-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">Model</th>
<th scope="col" class="org-right">Classification</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">Yes</td>
<td class="org-right">No</td>
</tr>

<tr>
<td class="org-left">True</td>
<td class="org-left">Yes</td>
<td class="org-right">490</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-left">Classification</td>
<td class="org-left">No</td>
<td class="org-right">100</td>
<td class="org-right">400</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>Cost: $0 for correct classification
<ul class="org-ul">
<li>$0.04 to read spam</li>
<li>$1 to miss a real message</li>
</ul></li>
<li>If 50% of email is spam, the total cost is &sum;:
<ol class="org-ol">
<li>490 &times; $0 + 440 &times; $0 = 0</li>
<li>10 &times; $1 = $10</li>
<li>100 &times; $0.04 = $4, i.e.</li>
</ol></li>
</ul>
<p>
$0.014 per email
</p>
<ul class="org-ul">
<li>If 40% of email is spam: total cost is &sum;:
<ol class="org-ol">
<li>490 &times; 0.6/0.5 &times; 0 + 400 &times; 0.4/0.5 \ times 0 = $0</li>
<li>10 &times; 0.6/0.5 &times; $1 = $12</li>
<li>100 &times; 0.4/0.5 &times; $0.04 = $3.2</li>
</ol></li>
</ul>
<p>
$0.0152 per email
</p>
</div>
</div>
<div id="outline-container-org47478a1" class="outline-4">
<h4 id="org47478a1"><span class="section-number-4">10.6.2.</span> Evaluating quality / changing metrics</h4>
<div class="outline-text-4" id="text-10-6-2">
<ul class="org-ul">
<li>E.g. make model stricter that can reject more spam</li>
<li>This can make model reject more spam, but also cause more false negatives (which are much more costly)
Hence overall cost is higher at $52 ($0.104 per email)</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgad68737" class="outline-3">
<h3 id="orgad68737"><span class="section-number-3">10.7.</span> L10L07: Advanced Topics in Regression</h3>
<div class="outline-text-3" id="text-10-7">
</div>
<div id="outline-container-orgd46467c" class="outline-4">
<h4 id="orgd46467c"><span class="section-number-4">10.7.1.</span> Poisson regression</h4>
<div class="outline-text-4" id="text-10-7-1">
<p>
Use when response follows a Poisson distribution i.e.
\[
f(z) = \frac{\lambda^Z e^{-z}}{z!}
\]
Examples:
</p>
<ul class="org-ul">
<li>Count of arrivals at airport security</li>
<li>Arrival rate might be function of <b>time</b></li>
<li>Hence, estimate &lambda;(x)</li>
</ul>
</div>
</div>
<div id="outline-container-org500803f" class="outline-4">
<h4 id="org500803f"><span class="section-number-4">10.7.2.</span> Regression splines</h4>
<div class="outline-text-4" id="text-10-7-2">
<p>
Spline: function of polynomials that connect to each other
<img src="./img/10-07-spline.png" alt="10-07-spline.png" />
</p>
<ul class="org-ul">
<li>Different functions are fitted to different parts of the data set</li>
<li>Hence, smoothens connections between parts</li>
<li>"Order-k" regression spline means that polynomials are all order k.</li>
<li>Example: multi-adaptive regression splines (MARS)
<ul class="org-ul">
<li>Called "Earth" in many stats libraries</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org2770bb4" class="outline-4">
<h4 id="org2770bb4"><span class="section-number-4">10.7.3.</span> Bayesian regression</h4>
<div class="outline-text-4" id="text-10-7-3">
<ul class="org-ul">
<li>Start with:
<ul class="org-ul">
<li>Data AND</li>
<li>Estimate of how regression coefficients and random error is distributed</li>
</ul></li>
<li>Example: to predict how tall a child will be as an adult, based on:
<ul class="org-ul">
<li>Data: heights of child's parents</li>
<li>Expert opinion: starting distribution, coefficients of father's and mother's heights are normally distributed between 0.8 and 1.2</li>
</ul></li>
<li>Then use Baye's theorem to update estimate</li>
<li><b>Helpful when data is lacking</b>:
<ul class="org-ul">
<li>Combines expert opinion with the data we do have.</li>
<li>Can replace expert opinion with a broad prior distribution (e.g., uniform over a large interval) as seed data</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org989a5ce" class="outline-4">
<h4 id="org989a5ce"><span class="section-number-4">10.7.4.</span> k-Nearest Neighbour Regression</h4>
<div class="outline-text-4" id="text-10-7-4">
<ul class="org-ul">
<li>Similar to KNN for classification</li>
<li>Hence, <b>KNN can be used for both regression and classification</b></li>
<li>Implementation:
<ul class="org-ul">
<li>No estimate of prediction function (function-less)</li>
<li>Plot all data</li>
<li>To predict response for a new point:
<ul class="org-ul">
<li>Average response of \(k\) closest data points</li>
</ul></li>
<li>Can be made fancier, e.g.:
<ul class="org-ul">
<li>Weight each dimension of distance</li>
<li>Removing dimensions that are not predictive</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org9a0c513" class="outline-2">
<h2 id="org9a0c513"><span class="section-number-2">11.</span> Module 11: Variable Selection</h2>
<div class="outline-text-2" id="text-11">
<ul class="org-ul">
<li>Factor based models:
<ol class="org-ol">
<li>Classification</li>
<li>Clustering</li>
<li>Regression</li>
</ol></li>
</ul>
</div>
<div id="outline-container-org8f6ac52" class="outline-3">
<h3 id="org8f6ac52"><span class="section-number-3">11.1.</span> M11L1: Introduction</h3>
<div class="outline-text-3" id="text-11-1">
</div>
<div id="outline-container-orgd86bea6" class="outline-4">
<h4 id="orgd86bea6"><span class="section-number-4">11.1.1.</span> Why bother limiting factors?</h4>
<div class="outline-text-4" id="text-11-1-1">
<ol class="org-ol">
<li>Prevents overfitting
<ul class="org-ul">
<li>When number of factors close to number of data points
<ul class="org-ul">
<li>Cause bad estimates</li>
</ul></li>
<li>Model fits too closely to the random effects</li>
</ul></li>
<li>Simplicity
<ul class="org-ul">
<li>Simple models better than complex models
<ul class="org-ul">
<li>Less data required</li>
<li>Less chance of insignificant factors</li>
<li>Easier to interpret</li>
</ul></li>
<li>Factors can be illegal to use
<ul class="org-ul">
<li>race, sex, religion, marital status cannot be used to make credit decisions</li>
<li>factors correlated to these also cannot be used</li>
</ul></li>
</ul></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org65edc62" class="outline-3">
<h3 id="org65edc62"><span class="section-number-3">11.2.</span> M11L2: Models for variable selection</h3>
<div class="outline-text-3" id="text-11-2">
</div>
<div id="outline-container-org5556535" class="outline-4">
<h4 id="org5556535"><span class="section-number-4">11.2.1.</span> Forward selection</h4>
<div class="outline-text-4" id="text-11-2-1">
<ul class="org-ul">
<li>Start with no factors, then add
<img src="file:///Users/whkoh/git-repos/omsa-notes/isye_6501/img/m11-fwd-sel.png" alt="m11-fwd-sel.png" /></li>
</ul>
</div>
</div>
<div id="outline-container-orgcc5206d" class="outline-4">
<h4 id="orgcc5206d"><span class="section-number-4">11.2.2.</span> Backward elimination</h4>
<div class="outline-text-4" id="text-11-2-2">
<ul class="org-ul">
<li>Start with all factors, then eliminate
<img src="file:///Users/whkoh/git-repos/omsa-notes/isye_6501/img/m11-backw-elim.png" alt="m11-backw-elim.png" /></li>
</ul>
</div>
</div>
<div id="outline-container-org1193637" class="outline-4">
<h4 id="org1193637"><span class="section-number-4">11.2.3.</span> Stepwise regression</h4>
<div class="outline-text-4" id="text-11-2-3">
<ul class="org-ul">
<li>Combines forward selection and backward elimination
<img src="file:///Users/whkoh/git-repos/omsa-notes/isye_6501/img/m11-stepwise.png" alt="m11-stepwise.png" /></li>
</ul>
</div>
</div>
<div id="outline-container-org53d7991" class="outline-4">
<h4 id="org53d7991"><span class="section-number-4">11.2.4.</span> Types of approaches</h4>
<div class="outline-text-4" id="text-11-2-4">
<ul class="org-ul">
<li>Greedy
<ul class="org-ul">
<li>Decisions are made stp by step</li>
<li>Known as <i>Greedy Algorithm</i></li>
<li>At each step, take one thing that looks best
<ul class="org-ul">
<li>Doesn't consider future options</li>
</ul></li>
</ul></li>
<li>Global (see below)</li>
</ul>
</div>
</div>
<div id="outline-container-orga1fa3a5" class="outline-4">
<h4 id="orga1fa3a5"><span class="section-number-4">11.2.5.</span> Lasso approach</h4>
<div class="outline-text-4" id="text-11-2-5">
<ul class="org-ul">
<li>Add constraint to standard regression equation
<ul class="org-ul">
<li>Still min SSE, <b>and</b> keep:</li>
<li>Sum of coefficients less than threshold T \(\sum_{j=1}^n|a_j| \leq T\)</li>
</ul></li>
<li>Gives regression a budget to use on coefficients
<ul class="org-ul">
<li>Most important coefficients kept</li>
<li>Others given 0</li>
</ul></li>
<li>Important to scale data and pick T correctly</li>
<li><b>Scaling</b> is important (e.g. age in years will be much bigger than age in days)</li>
<li>Picking \(T\) depends on:
<ol class="org-ol">
<li>Number of variables</li>
<li>Quality of model</li>
<li>Best tradeoff is to use LASSO method with different T values and assess</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org72abe28" class="outline-4">
<h4 id="org72abe28"><span class="section-number-4">11.2.6.</span> Elastic net</h4>
<div class="outline-text-4" id="text-11-2-6">
<ul class="org-ul">
<li>Constraint combination of abs. values of coefficients and their squares
\(\bar{\lambda}\sum_{j=1}^n|a_j| +(1-\bar{\lambda})\sum_{j=1}^na_j^2 \leq T\)</li>
<li>Important to scale data and pick T, \(\bar{\lambda}\) correctly</li>
</ul>
</div>
</div>
<div id="outline-container-orgb8bba54" class="outline-4">
<h4 id="orgb8bba54"><span class="section-number-4">11.2.7.</span> Ridge regression</h4>
<div class="outline-text-4" id="text-11-2-7">
<ul class="org-ul">
<li>Take out absolute value term from elastic net</li>
<li>Ridge regression doesn't do variable selection</li>
<li>It can lead to better predictive models</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org0ab502a" class="outline-3">
<h3 id="org0ab502a"><span class="section-number-3">11.3.</span> M11L3: Lasso vs Ridge regression</h3>
<div class="outline-text-3" id="text-11-3">
<ul class="org-ul">
<li></li>
</ul>
</div>
</div>
<div id="outline-container-orgfd60b53" class="outline-3">
<h3 id="orgfd60b53"><span class="section-number-3">11.4.</span> M11L4: Bias-Variance tradeoff</h3>
</div>
<div id="outline-container-org7f3fc2f" class="outline-3">
<h3 id="org7f3fc2f"><span class="section-number-3">11.5.</span> M11L5: Ridge regression / regularization</h3>
</div>
<div id="outline-container-orgea84824" class="outline-3">
<h3 id="orgea84824"><span class="section-number-3">11.6.</span> M11L6: Choosing a variable selection model</h3>
</div>
</div>
<div id="outline-container-org536014e" class="outline-2">
<h2 id="org536014e"><span class="section-number-2">12.</span> Module 12: Design of Experiments</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-org6709271" class="outline-3">
<h3 id="org6709271"><span class="section-number-3">12.1.</span> M12L1: Intro</h3>
<div class="outline-text-3" id="text-12-1">
<p>
What if dataset is hard to get/requires some process to get?
Examples:
</p>
<ol class="org-ol">
<li>determining which ad is better for advertising OMSA.</li>
<li>which similar or related product to show to users?</li>
<li>how to get representative sample of all relevant factors?</li>
<li>combinations of medical treatments</li>
<li>maximizing agricultural productiveness</li>
</ol>
</div>
<div id="outline-container-org7072bd1" class="outline-4">
<h4 id="org7072bd1"><span class="section-number-4">12.1.1.</span> Comparison and control</h4>
<div class="outline-text-4" id="text-12-1-1">
<ul class="org-ul">
<li>Answering whether red used cars sell for higher prices than blue used cars?</li>
<li>Control other factors:
<ol class="org-ol">
<li>Color</li>
<li>Age</li>
<li>Sports vs family car</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgbb67f8c" class="outline-4">
<h4 id="orgbb67f8c"><span class="section-number-4">12.1.2.</span> Blocking</h4>
<div class="outline-text-4" id="text-12-1-2">
<ul class="org-ul">
<li>A blocking factor creates variation</li>
<li>E.g. sports car vs family car</li>
<li>Sports car more likely to be red</li>
<li>Analyzing red sports cars vs red family cars have less variance than all red cars</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org1c19cf4" class="outline-3">
<h3 id="org1c19cf4"><span class="section-number-3">12.2.</span> M12L2: A/B testing</h3>
<div class="outline-text-3" id="text-12-2">
<p>
Choosing the best out of alternatives. Example:  banner ads: how to decide which version to show?
</p>
<ul class="org-ul">
<li>Show two different ads and how often each ad was clicked</li>
<li>This is binomial data; use hypothesis testing to test for statistical significance.</li>
</ul>
</div>
<div id="outline-container-org8bfa0fc" class="outline-4">
<h4 id="org8bfa0fc"><span class="section-number-4">12.2.1.</span> Required to use A/B testing</h4>
<div class="outline-text-4" id="text-12-2-1">
<ol class="org-ol">
<li>Data can be collected quickly</li>
<li>Data must be representative</li>
<li>Data collected is small vs. entire population (cost: does not make sense to spend 2000/2500 on building model. Remaining 500 too little to exploit.)</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org2f3018d" class="outline-3">
<h3 id="org2f3018d"><span class="section-number-3">12.3.</span> M12L3: Factorial design</h3>
<div class="outline-text-3" id="text-12-3">
</div>
<div id="outline-container-orgb813e36" class="outline-4">
<h4 id="orgb813e36"><span class="section-number-4">12.3.1.</span> Full factorial design</h4>
<div class="outline-text-4" id="text-12-3-1">
<ul class="org-ul">
<li>Test every combination and use ANOVA to determine the importance of each factor</li>
<li>Explodes with number of combinations, e.g. 7 factors x 3 choices = 3<sup>7</sup> = 2187 combinations</li>
</ul>
</div>
</div>
<div id="outline-container-org7821661" class="outline-4">
<h4 id="org7821661"><span class="section-number-4">12.3.2.</span> Fractional factorial design</h4>
<div class="outline-text-4" id="text-12-3-2">
<ul class="org-ul">
<li>Test subset of combinations</li>
<li>Balanced design
<ul class="org-ul">
<li>Test each choice the same # of times</li>
<li>Test each pair of choices the same # of times</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgb13c12e" class="outline-4">
<h4 id="orgb13c12e"><span class="section-number-4">12.3.3.</span> Independent factors</h4>
<div class="outline-text-4" id="text-12-3-3">
<ul class="org-ul">
<li>Factors need to be independent</li>
<li>Test subset of combinations
<ul class="org-ul">
<li>Use regression to estimate effects</li>
</ul></li>
<li>But there still some interaction factors, e.g. white background can't be used with white font color</li>
</ul>
</div>
</div>
<div id="outline-container-org8b64d70" class="outline-4">
<h4 id="org8b64d70"><span class="section-number-4">12.3.4.</span> Summary</h4>
<div class="outline-text-4" id="text-12-3-4">
<ul class="org-ul">
<li>Factorial methods can be very useful before data is collected</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgd9b647d" class="outline-3">
<h3 id="orgd9b647d"><span class="section-number-3">12.4.</span> M12L4: Multi-armed bandits</h3>
<div class="outline-text-3" id="text-12-4">
<ul class="org-ul">
<li>What if there are &gt; 2 possible alternatives</li>
</ul>
</div>
<div id="outline-container-org7fdf6fa" class="outline-4">
<h4 id="org7fdf6fa"><span class="section-number-4">12.4.1.</span> Exploration vs exploitation</h4>
<div class="outline-text-4" id="text-12-4-1">
<ul class="org-ul">
<li>With 10 alternatives, 1000 tests on each alternative:
<ul class="org-ul">
<li>10000 test total, but only 1 is best</li>
<li>So 9000 tests lost value</li>
</ul></li>
<li>Trade-off between having more information and immediate value
<dl class="org-dl">
<dt>Exploration</dt><dd>more information</dd>
<dt>Exploitation</dt><dd>immediate value</dd>
</dl></li>
</ul>
</div>
</div>
<div id="outline-container-orgb856e1d" class="outline-4">
<h4 id="orgb856e1d"><span class="section-number-4">12.4.2.</span> Multi-armed bandit</h4>
<div class="outline-text-4" id="text-12-4-2">
<ul class="org-ul">
<li>Finding the slot machine with the highest payout requires testing them all</li>
<li>Each slot machine is a 'single-armed bandit'</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org1743fa0"></a>Implementation<br />
<div class="outline-text-5" id="text-12-4-2-1">
<ol class="org-ol">
<li>Start with K alternatives, no information
<ul class="org-ul">
<li>Equal probability of selecting each alternative</li>
</ul></li>
<li>Repeat
<ul class="org-ul">
<li>Choose an alternative to test
<ul class="org-ul">
<li>Based on probability of each alternative being best</li>
</ul></li>
<li>After test, update probabilities of each one being best</li>
<li>Until the best alternative is clear</li>
</ul></li>
</ol>
</div>
</li>
<li><a id="orgf2aaa3e"></a>Parameters<br />
<div class="outline-text-5" id="text-12-4-2-2">
<ul class="org-ul">
<li>Number of tests between recalculating probabilities</li>
<li>How to update probabilities</li>
<li>How to pick an alternative to test based on probabilities and / or expected values</li>
</ul>
</div>
</li>
<li><a id="orgd3b09c2"></a>Summary<br />
<div class="outline-text-5" id="text-12-4-2-3">
<ul class="org-ul">
<li>No simple rule</li>
<li>Usually better than fix/large number of tests</li>
<li>Learn faster along the fly and create more value while doing so</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org1dc76ba" class="outline-2">
<h2 id="org1dc76ba"><span class="section-number-2">13.</span> Module 13: Probability-based Models</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-org2efc68a" class="outline-3">
<h3 id="org2efc68a"><span class="section-number-3">13.1.</span> M13L1: Intro</h3>
<div class="outline-text-3" id="text-13-1">
</div>
<div id="outline-container-org6189096" class="outline-4">
<h4 id="org6189096"><span class="section-number-4">13.1.1.</span> Simple modelling</h4>
<div class="outline-text-4" id="text-13-1-1">
<ul class="org-ul">
<li>Examples:
<ul class="org-ul">
<li>Airline security flows</li>
<li>Will season ticket owners show up?</li>
<li>Staffing fast food outlets</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org0bc4f5a" class="outline-4">
<h4 id="org0bc4f5a"><span class="section-number-4">13.1.2.</span> Example on ticket owner not showing up</h4>
<div class="outline-text-4" id="text-13-1-2">
<ul class="org-ul">
<li>How long should we wait before selling seat upgrade?</li>
<li>Fan can pay more if they get the seat earlier, however, this increases risk that the ticket owner will arrive</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="orga3efe50"></a>Factors<br />
<div class="outline-text-5" id="text-13-1-2-1">
<ul class="org-ul">
<li>About ticket holder (age, children, past data)</li>
<li>About the team (standings, players, etc)</li>
<li>About the game (opponent, star players, etc)</li>
<li>Day factors (week, season, holiday)</li>
</ul>
</div>
</li>
<li><a id="orgff20e8f"></a>Simple model can still work better<br />
<div class="outline-text-5" id="text-13-1-2-2">
<ul class="org-ul">
<li>Probability-distribution analysis can work just as well e.g. ticket holder X tends to arrive after about 60% of other fans</li>
<li>Less dependency vs other factors</li>
<li>Just use this instead of collecting other data</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-orga7b3e7b" class="outline-4">
<h4 id="orga7b3e7b"><span class="section-number-4">13.1.3.</span> Summary</h4>
<div class="outline-text-4" id="text-13-1-3">
<p>
Other examples that can work:
</p>
<ul class="org-ul">
<li>Broken equipment</li>
<li>Website purchases</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org45fd3a7" class="outline-3">
<h3 id="org45fd3a7"><span class="section-number-3">13.2.</span> M13L2: Bernoulli, Binomial and Geometric Distributions</h3>
<div class="outline-text-3" id="text-13-2">
</div>
<div id="outline-container-orga7f2e6b" class="outline-4">
<h4 id="orga7f2e6b"><span class="section-number-4">13.2.1.</span> Bernoulli distribution</h4>
<div class="outline-text-4" id="text-13-2-1">
<ul class="org-ul">
<li>E.g., flipping a coin that's not 50:50</li>
<li>Can specify:
<dl class="org-dl">
<dt>\(p\)</dt><dd>probability it comes up heads</dd>
<dt>$$1-p</dt><dd>probability that it comes up tails</dd>
</dl></li>
<li>By itself, talks about 1 data point</li>
<li>How to relate to other data points?</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org88b535c"></a>Example<br />
<div class="outline-text-5" id="text-13-2-1-1">
<ul class="org-ul">
<li>P(Sends donations) = p</li>
<li>p does not differ from month to month</li>
<li>Number of donations each month is binomially distributed</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-org43c5fdc" class="outline-4">
<h4 id="org43c5fdc"><span class="section-number-4">13.2.2.</span> Binomial distribution</h4>
<div class="outline-text-4" id="text-13-2-2">
<ul class="org-ul">
<li>Probability of getting \(x\) successes from \(n\) iid Bernoulli (\(p\)) trials</li>
<li><b><b>Large</b></b> \(n\):
<ul class="org-ul">
<li>Converges to normal distribution
<ul class="org-ul">
<li>Useful for predicting errors</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org3583403" class="outline-4">
<h4 id="org3583403"><span class="section-number-4">13.2.3.</span> Geometric distribution</h4>
<div class="outline-text-4" id="text-13-2-3">
<ul class="org-ul">
<li>Probability of having \(x\) Bernoulli (\(p\)) failures until first success?
<ul class="org-ul">
<li>Equivalently: having x Bernoulli (\(1-p\)) success until first failure</li>
</ul></li>
<li>Need to define \(p\) and \(1-p\) carefully</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org6c06009"></a>Can also answer questions about process<br />
<div class="outline-text-5" id="text-13-2-3-1">
<ul class="org-ul">
<li>If it fits geometric distribution, then hits are i.i.d. Bernoulli trials</li>
<li>If it does not fit, hits are not i.i.d., and need to consider other factors</li>
<li>Are airport screeners more likely to screen if there hasn't been a screening in a while?
<ul class="org-ul">
<li>Observe the graph and see whether it fits a geometric distribution</li>
</ul></li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org67a3d44" class="outline-3">
<h3 id="org67a3d44"><span class="section-number-3">13.3.</span> M13L3: Poisson, Weibull and Exponential Distributions</h3>
<div class="outline-text-3" id="text-13-3">
</div>
<div id="outline-container-org5673c68" class="outline-4">
<h4 id="org5673c68"><span class="section-number-4">13.3.1.</span> Poisson</h4>
<div class="outline-text-4" id="text-13-3-1">
<ul class="org-ul">
<li>Good at modelling random  arrivals
<dl class="org-dl">
<dt>&lambda;</dt><dd>the average number of arrivals per time period</dd>
</dl></li>
<li>Arrivals are i.i.d.</li>
</ul>
</div>
</div>
<div id="outline-container-orga5aadb3" class="outline-4">
<h4 id="orga5aadb3"><span class="section-number-4">13.3.2.</span> Exponential distribution</h4>
<div class="outline-text-4" id="text-13-3-2">
<ul class="org-ul">
<li>Related to Poisson</li>
<li>If arrivals are Poisson(&lambda;):
<ul class="org-ul">
<li>Time between successive arrivals is distributed by exponential(&lambda;) distribution</li>
</ul></li>
<li>Poisson # of arrivals &lt;==&gt; exponential inter-arrival time</li>
</ul>
</div>
</div>
<div id="outline-container-org632241d" class="outline-4">
<h4 id="org632241d"><span class="section-number-4">13.3.3.</span> Weibull</h4>
<div class="outline-text-4" id="text-13-3-3">
<ul class="org-ul">
<li>Models the <b>time</b> between failures</li>
<li>Whereas geometric models the <b>number of tries</b> between failures</li>
<li>\(k < 1\)
<ul class="org-ul">
<li>Modelling when failure rate <b>decreases</b> with time</li>
<li>"Worst things fail first"</li>
</ul></li>
<li>\(k > 1\)
<ul class="org-ul">
<li>Modelling when failure rate <b>increases</b> with time</li>
<li>"Things that wear out" e.g. tires</li>
</ul></li>
<li>\(k = 1\)
<ul class="org-ul">
<li>Modelling when failure rate is constant with time</li>
<li>This is equal to the <b>exponential distribution</b>
<ul class="org-ul">
<li>With different notation</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org0e78986" class="outline-4">
<h4 id="org0e78986"><span class="section-number-4">13.3.4.</span> Software can help but may be confusing</h4>
</div>
</div>
<div id="outline-container-org1e919f4" class="outline-3">
<h3 id="org1e919f4"><span class="section-number-3">13.4.</span> M13L4: Q-Q plots</h3>
<div class="outline-text-3" id="text-13-4">
</div>
<div id="outline-container-org7a8bc4c" class="outline-4">
<h4 id="org7a8bc4c"><span class="section-number-4">13.4.1.</span> Visualizing</h4>
<div class="outline-text-4" id="text-13-4-1">
<ul class="org-ul">
<li>Whether 2 distributions (different datasets) are about the same</li>
<li>Whether a dataset is distributed similarly to a probability distribution
<dl class="org-dl">
<dt>Horizontal axis</dt><dd>data</dd>
<dt>Vertical axis</dt><dd>theoretical values of percentiles of a probability distribution</dd>
</dl></li>
<li>Statistical tests work but can hide details about ranges, overall etc.</li>
</ul>
</div>
</div>
<div id="outline-container-org458d016" class="outline-4">
<h4 id="org458d016"><span class="section-number-4">13.4.2.</span> Types of Q-Q plots</h4>
<div class="outline-text-4" id="text-13-4-2">
<ul class="org-ul">
<li>Understand how to read the plots rather than memorize shapes</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org04492ea" class="outline-3">
<h3 id="org04492ea"><span class="section-number-3">13.5.</span> M13L5: Queuing</h3>
<div class="outline-text-3" id="text-13-5">
<ul class="org-ul">
<li>Telemarketing example with autodialer in marketing</li>
</ul>
</div>
<div id="outline-container-org161319f" class="outline-4">
<h4 id="org161319f"><span class="section-number-4">13.5.1.</span> Queuing example</h4>
<div class="outline-text-4" id="text-13-5-1">
<ul class="org-ul">
<li>Qn: how many employees should we have?</li>
<li>Variables:
<ul class="org-ul">
<li>Number of people who answer the autodialer</li>
<li>Duration of call once it starts</li>
</ul></li>
<li>Probability distributions:
<ul class="org-ul">
<li>Call arrives to queue:
<ul class="org-ul">
<li>Based on probability distribution of time between arrivals</li>
</ul></li>
<li>Call finish:
<ul class="org-ul">
<li>Based on probability distribution of talking time</li>
</ul></li>
</ul></li>
<li>Call arrival e.g. poisson</li>
<li>Call duration e.g. exponential</li>
</ul>
</div>
</div>
<div id="outline-container-orgbb74523" class="outline-4">
<h4 id="orgbb74523"><span class="section-number-4">13.5.2.</span> More complex example</h4>
<div class="outline-text-4" id="text-13-5-2">
<ul class="org-ul">
<li>New factors:
<ul class="org-ul">
<li>Limited number of calls in queue</li>
<li>Additional employee</li>
</ul></li>
<li>New concept: <b>memoryless property</b>
<ul class="org-ul">
<li>This means it doesn't matter what happened in the past, only what's happening <b>now</b></li>
<li>E.g. memoryless exponential distribution
<ul class="org-ul">
<li>Regardless of current call duration, the <i>remaining</i> call time distribution = <i>initial</i> distribution of call time using the distribution</li>
<li>Therefore can discover from the distribution</li>
</ul></li>
<li>E.g. memoryless Posson distribution</li>
</ul></li>
<li>If data fits exponential distribution =&gt; It is memoryless</li>
<li>Otherwise, not fitting exponential distribution =&gt; not memoryless</li>
</ul>
</div>
</div>
<div id="outline-container-orgb51d893" class="outline-4">
<h4 id="orgb51d893"><span class="section-number-4">13.5.3.</span> Queuing models</h4>
<div class="outline-text-4" id="text-13-5-3">
<ul class="org-ul">
<li>Parameters:
<dl class="org-dl">
<dt>A</dt><dd>General arrival distribution</dd>
<dt>S</dt><dd>General service distribution</dd>
<dt>c</dt><dd>Number of servers</dd>
<dt>K</dt><dd>Size of queue</dd>
<dt>N</dt><dd>Population size</dd>
<dt>D</dt><dd>Queuing discipline</dd>
</dl></li>
<li>Kendall notation M/M/1 queue</li>
<li>Potential extensions:
<ul class="org-ul">
<li>Hangups, balking etc</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orge202110" class="outline-3">
<h3 id="orge202110"><span class="section-number-3">13.6.</span> M13L6: Simulation basics</h3>
<div class="outline-text-3" id="text-13-6">
</div>
<div id="outline-container-orga382f02" class="outline-4">
<h4 id="orga382f02"><span class="section-number-4">13.6.1.</span> Types of simulations</h4>
<div class="outline-text-4" id="text-13-6-1">
<ul class="org-ul">
<li>Random behaviour?
<ul class="org-ul">
<li>Deterministic (no randomness)
<ul class="org-ul">
<li>Same inputs give identical outputs</li>
</ul></li>
<li>Stochastic (includes randoness)
<ul class="org-ul">
<li>Outputs may differ even for identical inputs</li>
</ul></li>
</ul></li>
<li>Time
<ul class="org-ul">
<li>Continuous-time
<ul class="org-ul">
<li>Changes happen continuously</li>
<li>E.g. chemical processes, disease spread</li>
<li>Use differential equation models</li>
</ul></li>
<li>Discrete event simulations
<ul class="org-ul">
<li>The <b>focus</b></li>
<li>Example: call center simulations</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org61e9b4a" class="outline-4">
<h4 id="org61e9b4a"><span class="section-number-4">13.6.2.</span> Discrete-event stochastic simulations</h4>
<div class="outline-text-4" id="text-13-6-2">
<ul class="org-ul">
<li>Use when systems have high variability</li>
<li>Averages are not good enough</li>
</ul>
</div>
</div>
<div id="outline-container-orgbecacc4" class="outline-4">
<h4 id="orgbecacc4"><span class="section-number-4">13.6.3.</span> Simulation software</h4>
<div class="outline-text-4" id="text-13-6-3">
<ul class="org-ul">
<li>Elements include:
<dl class="org-dl">
<dt>Entities</dt><dd>things that move through simulations, e.g. bags, people</dd>
<dt>Modules</dt><dd>represent part of process, e.g. queues, storage</dd>
<dt>Actions</dt><dd>thing to do</dd>
<dt>Resources</dt><dd>e.g. workers</dd>
<dt>Decision points</dt><dd>can affect flow</dd>
</dl></li>
<li>Can output statisntics for tracking</li>
<li>Random numbers are important!</li>
</ul>
</div>
</div>
<div id="outline-container-org0b17dc4" class="outline-4">
<h4 id="org0b17dc4"><span class="section-number-4">13.6.4.</span> Replications</h4>
<div class="outline-text-4" id="text-13-6-4">
<ul class="org-ul">
<li>The number of runs of simulation</li>
<li>One run is insufficient due to the random nature; not representative</li>
<li>Run multiple times to get distribution of outcomes</li>
<li>E.g. simulating average throughout</li>
</ul>
</div>
</div>
<div id="outline-container-org216a206" class="outline-4">
<h4 id="org216a206"><span class="section-number-4">13.6.5.</span> Simulation validation</h4>
<div class="outline-text-4" id="text-13-6-5">
<ul class="org-ul">
<li>Use real data to validate that the simulation is giving valid results
<ul class="org-ul">
<li>Problems:
<ul class="org-ul">
<li>Real average differs from simulated average</li>
<li>Real variance differs from simulated variance</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc500027" class="outline-3">
<h3 id="orgc500027"><span class="section-number-3">13.7.</span> M13L7: Prescriptive simulation</h3>
<div class="outline-text-3" id="text-13-7">
<ul class="org-ul">
<li>Once validated simulation, use it for "what-if" questions
<ul class="org-ul">
<li>e.g. what if $1000 is invested, what is the improvement?</li>
<li>where to place baggage tugs?</li>
</ul></li>
<li>Heuristic optimization can also be possible</li>
</ul>
</div>
<div id="outline-container-orgf322c2f" class="outline-4">
<h4 id="orgf322c2f"><span class="section-number-4">13.7.1.</span> Simulation comparisons</h4>
<div class="outline-text-4" id="text-13-7-1">
<p>
Can be run by hand:
</p>
<ul class="org-ul">
<li>e.g. 1 tug per gate
<ul class="org-ul">
<li>vs. 1 tug per two gates</li>
</ul></li>
<li>be careful, each could be influenced by which set of random numbers are chosen
<ul class="org-ul">
<li>Use the same random numbers for comparison</li>
</ul></li>
<li>Simulation can be a powerful tool but:
<ul class="org-ul">
<li>Model only as good as input's quality</li>
<li>Missing or incorrect information leads to incorrect answers</li>
</ul></li>
<li>Example: call center simulation
<ul class="org-ul">
<li>If it assumes all workers answer calls as quickly as each other, wrong, can lead to bad decisions</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org0664bfa" class="outline-4">
<h4 id="org0664bfa"><span class="section-number-4">13.7.2.</span> Validation can be hard</h4>
<div class="outline-text-4" id="text-13-7-2">
<ul class="org-ul">
<li>Especially if it's something that doesn't exist</li>
</ul>
</div>
</div>
<div id="outline-container-org02c4c4c" class="outline-4">
<h4 id="org02c4c4c"><span class="section-number-4">13.7.3.</span> Simulation/validation should consider all processes</h4>
<div class="outline-text-4" id="text-13-7-3">
<ul class="org-ul">
<li>E.g. data collection</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org5bc3023" class="outline-3">
<h3 id="org5bc3023"><span class="section-number-3">13.8.</span> M13L8: Markov chains</h3>
<div class="outline-text-3" id="text-13-8">
<ul class="org-ul">
<li>Based on states, e.g. cloudy, sunny, etc</li>
<li>For each state <i>i</i>,
<ul class="org-ul">
<li>p<sub>ij</sub> = transition probability from state <i>i</i> to state <i>j</i></li>
<li>P = {p<sub>ij</sub>} is the transition matrix</li>
</ul></li>
</ul>
</div>
<div id="outline-container-orge094b96" class="outline-4">
<h4 id="orge094b96"><span class="section-number-4">13.8.1.</span> Answering questions with the transition matrix</h4>
<div class="outline-text-4" id="text-13-8-1">
<ul class="org-ul">
<li>What's the long-run probability of rainy days?</li>
<li>&pi; = (0.5, 0.25, 0.25) for (Sunny, Cloudy, Rainy)</li>
<li>&pi; &times; P = (0.525, 0.25, 0.225) the probabilities of (Sunny, Cloudy, Rainy) tomorrow</li>
<li>&pi; &times; P<sup>2</sup> &#x2026;</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org5f1407c"></a>Long term probability?<br />
<div class="outline-text-5" id="text-13-8-1-1">
<ul class="org-ul">
<li>Use steady state to apply P and get the initial vector back
<ul class="org-ul">
<li>&pi; &times; P = &pi;</li>
</ul></li>
<li>Solve for &pi; P = &pi; and &sum;<sub>i</sub> &pi;<sub>i</sub> = 1</li>
<li>Not always a steady state</li>
<li><b><b>Steady state only exists when:</b></b>
<ol class="org-ol">
<li>possible to get from one state to all other states</li>
<li>no cyclic behaviour</li>
</ol></li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgd6b5550" class="outline-4">
<h4 id="orgd6b5550"><span class="section-number-4">13.8.2.</span> Key assumption</h4>
<div class="outline-text-4" id="text-13-8-2">
<ul class="org-ul">
<li>Memoryless:
<ul class="org-ul">
<li>State transitions only depend on <b>most recent</b> state
<ul class="org-ul">
<li>E.g. weather: tomorrow's only depends on today's</li>
</ul></li>
</ul></li>
<li>Most systems are not memoryless
<ul class="org-ul">
<li>But still useful because it's still useful e.g. for PageRank</li>
</ul></li>
<li>Other applications
<ol class="org-ol">
<li>Rank basketball teams</li>
<li>Urban sprawl, population, disease</li>
</ol></li>
<li>Markov chains can still work in long-run even if not memoryless in short-run</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org18433fa" class="outline-2">
<h2 id="org18433fa"><span class="section-number-2">14.</span> Module 14: Missing Data</h2>
</div>
<div id="outline-container-org76dd339" class="outline-2">
<h2 id="org76dd339"><span class="section-number-2">15.</span> Module 15: Optimization</h2>
</div>
<div id="outline-container-org3f41c67" class="outline-2">
<h2 id="org3f41c67"><span class="section-number-2">16.</span> Module 16: Advanced Models</h2>
<div class="outline-text-2" id="text-16">
<blockquote>
<p>
Midterm 2: modules 11-16 (from variable selection to optimization and advanced models) &#x2013; weeks 8-12
</p>
</blockquote>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: W</p>
<p class="date">Created: 2023-03-24 Fri 16:59</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
